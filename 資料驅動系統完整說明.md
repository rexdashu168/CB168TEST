# AI智能可轉債競拍系統 - 資料驅動版完整說明

## 🎯 系統核心理念

### **從286檔真實資料中學習，而非套用理論模型**

```
傳統方式（❌）          資料驅動方式（✅）
理論模型推測    →      286檔歷史統計
主觀經驗判斷    →      客觀數據分析  
固定參數權重    →      動態市場氛圍
```

---

## 📊 已建立的統計數據庫

### **檔案：cb_statistics.json**

包含286檔可轉債競拍案例的完整統計分析（2019-03-22 ~ 2025-09-18）

---

## 🔍 八大維度統計

### **1. 產業統計（31個產業）**

```json
"產業": {
  "其他電子業": {
    "樣本數": 20,
    "平均最低得標": 110.35,
    "平均最低溢價": 11.34,
    "平均得標價": 111.99,
    "平均溢價": 12.75
  },
  "半導體業": {
    "樣本數": 21,
    "平均最低得標": 107.89,
    "平均最低溢價": 9.49
  },
  ...
}
```

**關鍵發現：**
- 鋼鐵工業：平均溢價 18.01%（最高）
- 有擔保產業明顯溢價較高
- 電子相關產業競爭激烈

---

### **2. 發行規模統計（6個區間）**

```json
"發行規模": {
  "<2億": {
    "樣本數": 41,
    "平均最低得標": 109.20,
    "平均最低溢價": 9.34
  },
  "2-5億": {
    "樣本數": 115,
    "平均最低溢價": 8.81
  },
  "15-20億": {
    "樣本數": 12,
    "平均最低溢價": 5.49
  },
  ...
}
```

**關鍵發現：**
- 小規模（<2億）溢價較高：9.34%
- 大規模（>20億）溢價較低：6.54%
- 規模越大，競爭越弱

---

### **3. 股本統計（6個區間）**

```json
"股本": {
  "6-10億": {
    "樣本數": 84,
    "平均最低溢價": 10.05
  },
  "15-20億": {
    "樣本數": 22,
    "平均最低溢價": 6.32
  },
  ...
}
```

**關鍵發現：**
- 6-10億股本溢價最高：10.05%
- 股本對溢價影響相對較小

---

### **4. 年期統計（3種年期）**

```json
"年期": {
  "3年": {
    "樣本數": 224,
    "平均最低溢價": 9.51
  },
  "5年": {
    "樣本數": 61,
    "平均最低溢價": 6.34
  },
  "7年": {
    "樣本數": 1,
    "平均最低溢價": 2.00
  }
}
```

**關鍵發現：**
- 3年期最受歡迎：224檔（78%）
- 3年期溢價較高：9.51%
- 5年期溢價較低：6.34%

---

### **5. 擔保統計（2種類型）**

```json
"擔保": {
  "有擔保": {
    "樣本數": 94,
    "平均最低溢價": 11.24
  },
  "無擔保": {
    "樣本數": 192,
    "平均最低溢價": 7.66
  }
}
```

**關鍵發現：**
- **有擔保溢價高3.58%**（11.24% vs 7.66%）
- 有擔保是重要加分項

---

### **6. 信評統計（5個等級）**

```json
"信評": {
  "2-3分": {
    "樣本數": 6,
    "平均最低溢價": 9.68
  },
  "4-5分": {
    "樣本數": 95,
    "平均最低溢價": 9.85
  },
  "6-7分": {
    "樣本數": 155,
    "平均最低溢價": 8.32
  },
  "8-9分": {
    "樣本數": 28,
    "平均最低溢價": 8.86
  },
  "BBB": {
    "樣本數": 2,
    "平均最低溢價": -6.06
  }
}
```

**關鍵發現：**
- 4-5分溢價最高：9.85%
- 信評對溢價影響中等

---

### **7. 轉換價統計（6個區間）**

```json
"轉換價": {
  "20-50元": {
    "樣本數": 82,
    "平均最低溢價": 7.75
  },
  "150-200元": {
    "樣本數": 19,
    "平均最低溢價": 13.19
  },
  ">200元": {
    "樣本數": 34,
    "平均最低溢價": 12.07
  },
  ...
}
```

**關鍵發現：**
- 高轉換價（150元以上）溢價較高
- 20-50元區間樣本最多

---

### **8. 理論價統計（9個區間）**

```json
"理論價": {
  "<85元": {
    "樣本數": 12,
    "平均最低溢價": 26.68
  },
  "85-90元": {
    "樣本數": 20,
    "平均最低溢價": 18.60
  },
  "90-95元": {
    "樣本數": 51,
    "平均最低溢價": 12.95
  },
  "98-100元": {
    "樣本數": 46,
    "平均最低溢價": 5.02
  },
  ">110元": {
    "樣本數": 18,
    "平均最低溢價": -5.02
  }
}
```

**關鍵發現：**
- **理論價越低，溢價越高！**
- <85元：溢價26.68%（最高）
- >110元：溢價-5.02%（折價）
- 這是最重要的影響因素！

---

## 🌡️ 市場氛圍（自動計算）

### **系統自動從最近案例計算市場趨勢**

```json
"市場氛圍": {
  "近1月": {
    "案例數": 6,
    "平均最低溢價": 8.25,
    "趨勢": "急劇下降",
    "建議調整": -0.6,
    "開始日期": "2025-08-19"
  },
  "近3月": {
    "案例數": 15,
    "平均最低溢價": 6.74,
    "趨勢": "強勢上升",
    "建議調整": 0.7
  },
  "近6月": {
    "案例數": 25,
    "平均最低溢價": 6.49,
    "趨勢": "平穩",
    "建議調整": 0.0
  },
  "近1年": {
    "案例數": 72,
    "平均最低溢價": 7.74,
    "趨勢": "急劇下降",
    "建議調整": -0.6
  }
}
```

### **市場氛圍判斷邏輯：**

```
比較「前半期」與「後半期」的平均溢價：

溢價變化 > 2%  → 強勢上升 → 建議調整 +0.7%
溢價變化 > 1%  → 溫和上升 → 建議調整 +0.4%
-1% < 變化 < 1% → 平穩    → 建議調整 0.0%
溢價變化 < -1% → 溫和下降 → 建議調整 -0.3%
溢價變化 < -2% → 急劇下降 → 建議調整 -0.6%
```

### **目前市場狀況（2025-09）：**
- 近1月：急劇下降（-0.6%調整）
- 近3月：強勢上升（+0.7%調整）
- 近6月：平穩（0.0%調整）
- 近1年：急劇下降（-0.6%調整）

**→ 系統會採用「近3月」的數據（最新且樣本足夠）**

---

## 🤖 新的AI評估邏輯

### **Step 1: 使用者輸入新標的**

```
使用者只需輸入：
✅ 產業分類
✅ 發行規模
✅ 股本
✅ 年期
✅ 擔保情況
✅ 信評
✅ 轉換價
✅ 截標日股價

❌ 不需要輸入「市場氛圍」（系統自動計算）
```

### **Step 2: 計算理論價格**

```javascript
理論價格 = (截標日股價 / 轉換價) × 100
```

### **Step 3: 查表取得各維度溢價**

從統計數據中查表：

```javascript
產業溢價 = statistics['維度統計']['產業'][使用者輸入的產業]['平均最低溢價']
規模溢價 = statistics['維度統計']['發行規模'][對應區間]['平均最低溢價']
股本溢價 = statistics['維度統計']['股本'][對應區間]['平均最低溢價']
年期溢價 = statistics['維度統計']['年期'][對應年期]['平均最低溢價']
擔保溢價 = statistics['維度統計']['擔保'][有/無擔保]['平均最低溢價']
信評溢價 = statistics['維度統計']['信評'][對應等級]['平均最低溢價']
轉換價溢價 = statistics['維度統計']['轉換價'][對應區間]['平均最低溢價']
理論價溢價 = statistics['維度統計']['理論價'][對應區間]['平均最低溢價']

市場氛圍調整 = statistics['市場氛圍']['近3月']['建議調整']
```

### **Step 4: 加權平均計算**

```javascript
綜合溢價率 = 
  理論價溢價 × 0.30 +        // 最重要！
  擔保溢價 × 0.20 +          // 第二重要
  產業溢價 × 0.15 +          
  規模溢價 × 0.10 +          
  信評溢價 × 0.10 +          
  轉換價溢價 × 0.08 +        
  年期溢價 × 0.05 +          
  股本溢價 × 0.02 +          
  市場氛圍調整               // 自動加入
```

**權重說明：**
- 理論價：30%（影響最大）
- 擔保：20%（有擔保差異明顯）
- 產業：15%（產業差異大）
- 其他因素：35%

### **Step 5: 計算投標價格**

```javascript
預估最低得標價 = 理論價格 × (1 + 綜合溢價率 / 100)

三種策略：
- 保守策略：預估價 × 0.95（接近最低價）
- 平衡策略：預估價 × 1.00（預估價）
- 積極策略：預估價 × 1.05（確保得標）
```

### **Step 6: 顯示相似案例**

```
從286檔中搜尋最相似的3-5個案例：
1. 產業相同
2. 理論價接近（±5元）
3. 擔保情況相同
4. 規模接近

顯示這些案例的：
- 最低得標價
- 平均得標價
- 實際溢價率
```

---

## 📋 系統優勢

### **1. 數據驅動**
✅ 286檔真實案例統計
✅ 不是理論推測
✅ 可回測驗證

### **2. 自動更新**
✅ 市場氛圍自動計算
✅ 無需手動輸入
✅ 反映最新趨勢

### **3. 可解釋**
✅ 每個數字都有統計依據
✅ 顯示歷史相似案例
✅ 使用者可以理解邏輯

### **4. 持續進化**
✅ 每次新開標後更新統計
✅ 系統自動優化
✅ 準確度持續提升

---

## 🎯 下一步開發

### **Phase 1：前端整合（現在做）**
1. 修改HTML表單（移除市場氛圍輸入）
2. 整合cb_statistics.json
3. 實作查表計算邏輯
4. 顯示相似案例

### **Phase 2：相似案例搜尋**
1. 建立案例搜尋引擎
2. 多維度相似度計算
3. 顯示歷史參考

### **Phase 3：回測驗證**
1. 用過去資料測試準確度
2. 計算預測誤差
3. 優化權重係數

### **Phase 4：持續更新**
1. 每次新開標後更新統計
2. 重新計算市場氛圍
3. 自動優化系統

---

## 📊 統計數據檔案

### **cb_statistics.json**
- 路徑：`/mnt/user-data/outputs/cb_statistics.json`
- 大小：5,290 bytes
- 包含：286檔完整統計數據
- 更新：2025-11-03

### **使用方式：**
```javascript
// 在前端載入
fetch('cb_statistics.json')
  .then(response => response.json())
  .then(stats => {
    // 使用統計數據進行計算
    const 產業溢價 = stats['維度統計']['產業'][產業名稱]['平均最低溢價'];
    // ...
  });
```

---

**系統已完成資料統計階段，準備進入前端整合！** 🎉

Rex大叔的168台股投資教室
2025-11-03
