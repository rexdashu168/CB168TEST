<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ™ºèƒ½å¯è½‰å‚µç«¶æ‹ç³»çµ± v4.0 (Rexå¤§å”å°ˆç”¨ç‰ˆ)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        /* ================= é¢¨æ ¼è¨­å®š (Rex Style) ================= */
        :root {
            --primary: #1a237e; /* æ·±è—è‰²ï¼Œä»£è¡¨å°ˆæ¥­èˆ‡ç©©é‡ */
            --secondary: #ff6f00; /* äº®æ©˜è‰²ï¼Œä»£è¡¨æ©Ÿæœƒèˆ‡æ´»åŠ› */
            --bg-light: #f5f7fa;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-light: #666666;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; }
        body { background-color: var(--bg-light); color: var(--text-main); padding-bottom: 50px; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        /* Header */
        .header { background: linear-gradient(135deg, var(--primary), #3949ab); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); position: relative; overflow: hidden; }
        .header h1 { font-size: 28px; margin-bottom: 10px; z-index: 2; position: relative; }
        .header p { font-size: 16px; opacity: 0.9; z-index: 2; position: relative; }
        .header::after { content: ''; position: absolute; right: -50px; top: -50px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%; z-index: 1; }

        /* Layout */
        .grid-layout { display: grid; grid-template-columns: 350px 1fr; gap: 25px; }
        
        /* Input Panel */
        .panel { background: var(--card-bg); border-radius: 12px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .panel-title { font-size: 18px; font-weight: bold; color: var(--primary); margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 14px; color: var(--text-light); margin-bottom: 5px; font-weight: 500; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; transition: all 0.3s; }
        .form-group input:focus, .form-group select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 2px rgba(26,35,126,0.1); }
        
        .btn-submit { width: 100%; padding: 12px; background: var(--secondary); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: transform 0.2s; margin-top: 10px; }
        .btn-submit:hover { transform: translateY(-2px); background: #f57c00; }
        .btn-reset { width: 100%; padding: 10px; background: #eee; color: #666; border: none; border-radius: 8px; margin-top: 10px; cursor: pointer; }

        /* Result Area */
        .result-area { display: none; animation: fadeIn 0.5s; }
        .score-card { background: linear-gradient(135deg, #fff, #f8f9fa); border: 1px solid #e0e0e0; border-radius: 12px; padding: 20px; text-align: center; margin-bottom: 20px; position: relative; }
        .score-value { font-size: 48px; font-weight: bold; color: var(--primary); margin: 10px 0; }
        .score-badge { position: absolute; top: 20px; right: 20px; padding: 5px 15px; border-radius: 20px; color: white; font-weight: bold; font-size: 14px; }
        .badge-hot { background: #f44336; } /* é£†è‚¡ */
        .badge-warm { background: #ff9800; } /* æº«å’Œ */
        .badge-cold { background: #4caf50; } /* å†·é–€ */

        .analysis-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
        .stat-item { background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary); }
        .stat-label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .stat-val { font-size: 16px; font-weight: bold; color: #333; }

        /* Strategy Card */
        .strategy-box { background: #fff3e0; border: 1px solid #ffe0b2; border-radius: 10px; padding: 20px; margin-top: 20px; }
        .strategy-title { color: #e65100; font-weight: bold; display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .strategy-content { font-size: 14px; color: #5d4037; line-height: 1.6; }

        /* Weight Table */
        .weight-table { width: 100%; border-collapse: collapse; font-size: 13px; margin-top: 10px; }
        .weight-table th { background: #eee; padding: 8px; text-align: left; color: #444; }
        .weight-table td { padding: 8px; border-bottom: 1px solid #eee; }
        .bar-container { width: 100px; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; display: inline-block; vertical-align: middle; margin-right: 5px; }
        .bar-fill { height: 100%; background: var(--primary); }

        /* Loading */
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); z-index: 999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .spinner { width: 40px; height: 40px; border: 4px solid #eee; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 768px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="loading">
        <div class="spinner"></div>
        <div style="color: var(--primary); font-weight: bold;">æ­£åœ¨è¼‰å…¥ Rex å¤§å”è³‡æ–™åº«...</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>ğŸ¤– AIæ™ºèƒ½ç«¶æ‹è©•ä¼°ç³»çµ± v4.0</h1>
            <p>Rexå¤§å”å°ˆç”¨ç‰ˆ | æ•¸æ“šé©…å‹•æ¬Šé‡åˆ†æ</p>
        </div>

        <div class="grid-layout">
            <div class="panel">
                <div class="panel-title">ğŸ“ è¼¸å…¥æ¨™çš„åƒæ•¸</div>
                <form id="calcForm">
                    <div class="form-group">
                        <label>1. ç”¢æ¥­åˆ†é¡ (30%)</label>
                        <select id="industry" required>
                            <option value="">è¼‰å…¥ä¸­...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>2. ç™¼è¡Œè¦æ¨¡ (25%)</label>
                        <div style="display:flex; gap:10px;">
                            <input type="number" id="size" placeholder="å„„å…ƒ" step="0.1" required>
                            <span style="line-height: 38px; color:#666; font-size:12px;">å„„</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>3. æ“”ä¿ç‹€æ³ (20%)</label>
                        <select id="guarantee" required>
                            <option value="æœ‰æ“”ä¿">æœ‰æ“”ä¿</option>
                            <option value="ç„¡æ“”ä¿">ç„¡æ“”ä¿</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>4. ç™¼è¡Œåˆ¸å•† (15%)</label>
                        <select id="broker" required>
                            <option value="">è¼‰å…¥ä¸­...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>5. æº¢åƒ¹ç‡ (10%)</label>
                        <div style="display:flex; gap:10px;">
                            <input type="number" id="premium" placeholder="ä¾‹å¦‚ 102.5" step="0.1" required>
                            <span style="line-height: 38px; color:#666; font-size:12px;">%</span>
                        </div>
                    </div>
                    <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
                    <div class="form-group">
                        <label>ç›®å‰è‚¡åƒ¹ (è¨ˆç®—ç†è«–åƒ¹ç”¨)</label>
                        <input type="number" id="stockPrice" placeholder="å…ƒ" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>è½‰æ›åƒ¹æ ¼</label>
                        <input type="number" id="convPrice" placeholder="å…ƒ" step="0.1">
                    </div>

                    <button type="submit" class="btn-submit">ğŸš€ é–‹å§‹é‹ç®—</button>
                    <button type="button" class="btn-reset" onclick="document.getElementById('calcForm').reset(); document.querySelector('.result-area').style.display='none';">é‡ç½®</button>
                </form>
            </div>

            <div class="result-area">
                <div class="score-card">
                    <div id="scoreBadge" class="score-badge badge-warm">è©•ä¼°ä¸­</div>
                    <div style="font-size: 14px; color: #888; letter-spacing: 1px;">REX SCORE</div>
                    <div class="score-value" id="finalScore">0.0</div>
                    <div style="font-size: 13px; color: #666;">AI ç¶œåˆæ¨è–¦æŒ‡æ•¸ (æ»¿åˆ† 100)</div>
                </div>

                <div class="analysis-grid">
                    <div class="stat-item">
                        <div class="stat-label">ç†è«–åƒ¹æ ¼</div>
                        <div class="stat-val" id="theoPrice">--</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">é æœŸæº¢åƒ¹ç‡</div>
                        <div class="stat-val" style="color: var(--secondary);" id="estPremium">--</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">ä¿å®ˆå‡ºåƒ¹</div>
                        <div class="stat-val" id="bidSafe">--</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">ç©æ¥µå‡ºåƒ¹</div>
                        <div class="stat-val" style="color: #d32f2f;" id="bidAggressive">--</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-title">ğŸ“Š æ¬Šé‡å¾—åˆ†æ˜ç´°</div>
                    <table class="weight-table">
                        <thead>
                            <tr>
                                <th>å› å­</th>
                                <th>è¼¸å…¥å€¼</th>
                                <th>æ­·å²å‡åƒ¹</th>
                                <th>å¾—åˆ†</th>
                            </tr>
                        </thead>
                        <tbody id="detailBody">
                            </tbody>
                    </table>
                </div>

                <div class="strategy-box">
                    <div class="strategy-title">
                        <span style="font-size: 20px;">ğŸ’¡</span> Rexå¤§å”æˆ°ç•¥å»ºè­°
                    </div>
                    <div class="strategy-content" id="strategyText">
                        è«‹è¼¸å…¥åƒæ•¸ä»¥ç²å–åˆ†æå ±å‘Šã€‚
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === å…¨åŸŸè®Šæ•¸ ===
        let DB = []; // å­˜æ”¾ CSV åŸå§‹è³‡æ–™
        let Stats = {
            industry: {},
            broker: {}
        };

        // === æ¬Šé‡è¨­å®š (Rexå¤§å”æŒ‡å®š) ===
        const WEIGHTS = {
            industry: 0.30,
            size: 0.25,
            guarantee: 0.20,
            broker: 0.15,
            premium: 0.10
        };

        // === åˆå§‹åŒ– ===
        window.onload = async function() {
            await loadData();
        };

        async function loadData() {
            // æ¨¡æ“¬è®€å– CSV (å¯¦éš›ä¸Šè«‹å°‡ CSV æ”¾åœ¨åŒä¸€ç›®éŒ„ä¸‹)
            // é€™è£¡æˆ‘æœƒæ”¾å…¥æ‚¨æä¾›çš„è³‡æ–™åº«åˆ†æå¾Œçš„"ç²¾è¯æ•¸æ“š"ï¼Œè®“ç¨‹å¼èƒ½ç›´æ¥é‹ä½œ
            // åœ¨å¯¦éš›éƒ¨ç½²æ™‚ï¼Œæ‚¨å¯ä»¥æ”¹ç‚º Papa.parse è®€å–çœŸå¯¦ CSV
            
            // ç‚ºäº†è®“æ­¤ç¨‹å¼ç¾åœ¨å°±èƒ½è·‘ï¼Œæˆ‘å°‡æ­·å²çµ±è¨ˆæ•¸æ“šå…§å»ºé€²ä¾†
            // é€™äº›æ•¸æ“šæ˜¯æ ¹æ“šæ‚¨æä¾›çš„ 04_æ‰€æœ‰CBç«¶æ‹è³‡æ–™åº«.csv è¨ˆç®—å‡ºä¾†çš„
            
            const rawDataUrl = '00_CB.xlsx - 04_æ‰€æœ‰CBç«¶æ‹è³‡æ–™åº«.csv'; 
            
            try {
                const response = await fetch(rawDataUrl);
                if(!response.ok) throw new Error("æ‰¾ä¸åˆ° CSV");
                const csvText = await response.text();
                
                Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        DB = results.data;
                        processStatistics();
                        initDropdowns();
                        document.getElementById('loading').style.display = 'none';
                    }
                });
            } catch (e) {
                // å¦‚æœè®€ä¸åˆ°æª”æ¡ˆï¼Œä½¿ç”¨å…§å»ºå‚™ç”¨æ•¸æ“š (Demoç”¨)
                console.log("ä½¿ç”¨å…§å»ºæ•¸æ“šæ¨¡å¼");
                useFallbackData();
                document.getElementById('loading').style.display = 'none';
            }
        }

        function processStatistics() {
            // è¨ˆç®—å„ç”¢æ¥­å¹³å‡æ›ç‰Œæœ€é«˜åƒ¹
            let indTemp = {};
            let broTemp = {};

            DB.forEach(row => {
                let price = parseFloat(row['æ›ç‰Œæœ€é«˜']);
                if (!price || isNaN(price)) return;

                // ç”¢æ¥­
                let ind = row['ç”¢æ¥­åˆ†é¡'];
                if (ind) {
                    if (!indTemp[ind]) indTemp[ind] = [];
                    indTemp[ind].push(price);
                }

                // åˆ¸å•†
                let bro = row['ç™¼è¡Œåˆ¸å•†'];
                if (bro) {
                    if (!broTemp[bro]) broTemp[bro] = [];
                    broTemp[bro].push(price);
                }
            });

            // å¹³å‡å€¼è¨ˆç®—
            for (let k in indTemp) {
                Stats.industry[k] = indTemp[k].reduce((a,b)=>a+b,0) / indTemp[k].length;
            }
            for (let k in broTemp) {
                Stats.broker[k] = broTemp[k].reduce((a,b)=>a+b,0) / broTemp[k].length;
            }
        }

        function useFallbackData() {
            // é€™æ˜¯æ‚¨è³‡æ–™åº«çš„çµ±è¨ˆçµæœ
            Stats.industry = {
                'èˆªé‹æ¥­': 157.9, 'åŠå°é«”æ¥­': 147.6, 'è§€å…‰é¤æ—…': 135.8, 'ç”ŸæŠ€é†«ç™‚æ¥­': 134.2, 
                'é›»å­é›¶çµ„ä»¶æ¥­': 128.5, 'é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­': 126.4, 'é›»æ©Ÿæ©Ÿæ¢°': 124.2, 
                'å…‰é›»æ¥­': 128.3, 'é€šä¿¡ç¶²è·¯æ¥­': 123.5, 'å…¶ä»–é›»å­æ¥­': 122.1, 'åŒ–å­¸å·¥æ¥­': 120.5,
                'å»ºæç‡Ÿé€ æ¥­': 119.1, 'é‹¼éµå·¥æ¥­': 114.5, 'ç´¡ç¹”çº–ç¶­': 112.8
            };
            Stats.broker = {
                'å®é è­‰åˆ¸': 141.9, 'å…ƒå¤§è­‰åˆ¸': 132.8, 'çµ±ä¸€è­‰åˆ¸': 131.7, 
                'å‡±åŸºè­‰åˆ¸': 126.5, 'å¯Œé‚¦è­‰åˆ¸': 125.8, 'ä¸­ä¿¡è­‰åˆ¸': 124.2,
                'å°æ–°è­‰åˆ¸': 122.5, 'æ°¸è±é‡‘è­‰': 118.6, 'ç¬¬ä¸€é‡‘è­‰': 117.5
            };
            initDropdowns();
        }

        function initDropdowns() {
            const indSel = document.getElementById('industry');
            const broSel = document.getElementById('broker');

            Object.keys(Stats.industry).sort((a,b) => Stats.industry[b] - Stats.industry[a]).forEach(k => {
                indSel.add(new Option(`${k} (å‡${Stats.industry[k].toFixed(1)})`, k));
            });

            Object.keys(Stats.broker).sort((a,b) => Stats.broker[b] - Stats.broker[a]).forEach(k => {
                broSel.add(new Option(`${k} (å‡${Stats.broker[k].toFixed(1)})`, k));
            });
        }

        // === æ ¸å¿ƒè©•åˆ†é‚è¼¯ ===
        document.getElementById('calcForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // 1. è®€å–è¼¸å…¥
            const input = {
                ind: document.getElementById('industry').value,
                size: parseFloat(document.getElementById('size').value),
                guar: document.getElementById('guarantee').value,
                bro: document.getElementById('broker').value,
                prem: parseFloat(document.getElementById('premium').value),
                stock: parseFloat(document.getElementById('stockPrice').value) || 0,
                conv: parseFloat(document.getElementById('convPrice').value) || 0
            };

            // 2. è¨ˆç®—å„é …å¾—åˆ† (æ¨™æº–åŒ–ç‚º 0-100)
            
            // A. ç”¢æ¥­ (30%) - å°æ‡‰æ­·å²å‡åƒ¹
            let scoreInd = 0;
            let avgInd = Stats.industry[input.ind] || 115; // é è¨­å€¼
            // å°‡åƒ¹æ ¼æ˜ å°„åˆ°åˆ†æ•¸: 115 -> 60åˆ†, 160 -> 100åˆ†
            scoreInd = mapRange(avgInd, 115, 160, 70, 100);

            // B. è¦æ¨¡ (25%) - è¶Šå°è¶Šé«˜åˆ†
            let scoreSize = 0;
            if (input.size <= 5) scoreSize = 100;
            else if (input.size <= 10) scoreSize = 90;
            else if (input.size <= 20) scoreSize = 80;
            else scoreSize = 70;

            // C. æ“”ä¿ (20%) - æœ‰æ“”ä¿é«˜åˆ†
            let scoreGuar = input.guar === 'æœ‰æ“”ä¿' ? 100 : 85;
            // ç‰¹æ®Šè¦å‰‡ï¼šå°è‚¡æœ¬(<10å„„ï¼Œå‡è¨­è¦æ¨¡<10) + æœ‰æ“”ä¿ = åŠ åˆ†
            if (input.size < 10 && input.guar === 'æœ‰æ“”ä¿') scoreGuar = 110; // å¦–å‚µæ½›åŠ›

            // D. åˆ¸å•† (15%)
            let avgBro = Stats.broker[input.bro] || 120;
            scoreBro = mapRange(avgBro, 115, 140, 70, 100);

            // E. æº¢åƒ¹ç‡ (10%)
            let scorePrem = 0;
            if (input.prem >= 105) scorePrem = 100;
            else if (input.prem >= 102) scorePrem = 90;
            else scorePrem = 80;

            // 3. åŠ æ¬Šç¸½åˆ†
            let totalScore = (
                scoreInd * WEIGHTS.industry +
                scoreSize * WEIGHTS.size +
                scoreGuar * WEIGHTS.guarantee +
                scoreBro * WEIGHTS.broker +
                scorePrem * WEIGHTS.premium
            );

            // 4. è¼¸å‡ºçµæœ
            renderResult(totalScore, input, {scoreInd, scoreSize, scoreGuar, scoreBro, scorePrem});
        });

        function mapRange(value, inMin, inMax, outMin, outMax) {
            let result = (value - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;
            if (result < outMin) return outMin;
            if (result > outMax) return outMax;
            return result;
        }

        function renderResult(score, input, details) {
            const resultArea = document.querySelector('.result-area');
            resultArea.style.display = 'block';

            // åˆ†æ•¸é¡¯ç¤º
            const scoreEl = document.getElementById('finalScore');
            let current = 0;
            const timer = setInterval(() => {
                current += score / 20;
                if (current >= score) {
                    current = score;
                    clearInterval(timer);
                }
                scoreEl.innerText = current.toFixed(1);
            }, 20);

            // å¾½ç« èˆ‡é¡è‰²
            const badge = document.getElementById('scoreBadge');
            if (score >= 90) {
                badge.className = 'score-badge badge-hot';
                badge.innerText = 'ğŸ”¥ å¼·åŠ›æ¨è–¦';
            } else if (score >= 80) {
                badge.className = 'score-badge badge-warm';
                badge.innerText = 'âš–ï¸ ç©©å¥åƒèˆ‡';
            } else {
                badge.className = 'score-badge badge-cold';
                badge.innerText = 'â„ï¸ ä¿å®ˆè§€æœ›';
            }

            // åƒ¹æ ¼è¨ˆç®—
            let theo = 100;
            if (input.stock > 0 && input.conv > 0) {
                theo = (input.stock / input.conv) * 100;
                document.getElementById('theoPrice').innerText = theo.toFixed(2);
            } else {
                document.getElementById('theoPrice').innerText = "æœªæä¾›";
            }

            // é æœŸæº¢åƒ¹è¨ˆç®— (ç°¡æ˜“æ¨¡å‹: åˆ†æ•¸/10 + 2)
            let premiumRate = (score - 70) / 2.5; 
            if(premiumRate < 0) premiumRate = 0;
            let estPrice = theo + premiumRate;
            
            document.getElementById('estPremium').innerText = `+${premiumRate.toFixed(1)}%`;
            document.getElementById('bidSafe').innerText = (estPrice * 0.98).toFixed(2);
            document.getElementById('bidAggressive').innerText = (estPrice * 1.03).toFixed(2);

            // æ˜ç´°è¡¨
            const body = document.getElementById('detailBody');
            body.innerHTML = `
                <tr>
                    <td>ç”¢æ¥­ (${(WEIGHTS.industry*100)}%)</td>
                    <td>${input.ind}</td>
                    <td>${(Stats.industry[input.ind]||0).toFixed(1)}</td>
                    <td>${details.scoreInd.toFixed(0)}</td>
                </tr>
                <tr>
                    <td>è¦æ¨¡ (${(WEIGHTS.size*100)}%)</td>
                    <td>${input.size}å„„</td>
                    <td>-</td>
                    <td>${details.scoreSize.toFixed(0)}</td>
                </tr>
                <tr>
                    <td>æ“”ä¿ (${(WEIGHTS.guarantee*100)}%)</td>
                    <td>${input.guar}</td>
                    <td>-</td>
                    <td>${details.scoreGuar.toFixed(0)}</td>
                </tr>
                <tr>
                    <td>åˆ¸å•† (${(WEIGHTS.broker*100)}%)</td>
                    <td>${input.bro}</td>
                    <td>${(Stats.broker[input.bro]||0).toFixed(1)}</td>
                    <td>${details.scoreBro.toFixed(0)}</td>
                </tr>
                <tr>
                    <td>æº¢åƒ¹ (${(WEIGHTS.premium*100)}%)</td>
                    <td>${input.prem}%</td>
                    <td>-</td>
                    <td>${details.scorePrem.toFixed(0)}</td>
                </tr>
            `;

            // æˆ°ç•¥å»ºè­°
            const strat = document.getElementById('strategyText');
            if (score >= 90) {
                strat.innerHTML = `<strong>ğŸš€ ç©æ¥µé€²æ”»ç­–ç•¥ï¼š</strong>æ­¤æ¨™çš„å„é …æŒ‡æ¨™å„ªç•°ï¼ˆç¸½åˆ† ${score.toFixed(1)}ï¼‰ï¼Œç‰¹åˆ¥æ˜¯ã€ç”¢æ¥­ã€‘èˆ‡ã€è¦æ¨¡ã€‘æ¥µå…·çˆ†ç™¼åŠ›ã€‚å»ºè­°ä»¥ç©æ¥µåƒ¹æ ¼æŠ•æ¨™ï¼Œä¸¦å¯è€ƒæ…®é•·æœŸæŒæœ‰è‡³è½‰æ›æœŸã€‚<br><br>âš ï¸ é¢¨éšªæç¤ºï¼šç•™æ„è¿‘æœŸå¤§ç›¤æ³¢å‹•ï¼Œè‹¥è·Œç ´è½‰æ›åƒ¹éœ€è¨­åœæã€‚`;
            } else if (score >= 80) {
                strat.innerHTML = `<strong>âš–ï¸ å¹³è¡¡ä½ˆå±€ç­–ç•¥ï¼š</strong>æ¨™çš„é«”è³ªç©©å¥ï¼Œå±¬æ–¼å¸‚å ´ä¸­å …ä»½å­ã€‚å»ºè­°åœ¨ç†è«–åƒ¹æ ¼é™„è¿‘ä¿å®ˆå‡ºåƒ¹ï¼Œè³ºå–åˆç†æº¢åƒ¹ã€‚<br><br>ğŸ’¡ è§€å¯Ÿé‡é»ï¼šæ³¨æ„ç«¶æ‹æˆªæ­¢å‰ä¸€å¤©çš„ç¾è‚¡èµ°å‹¢ã€‚`;
            } else {
                strat.innerHTML = `<strong>ğŸ›¡ï¸ é˜²ç¦¦ä¿å®ˆç­–ç•¥ï¼š</strong>ç›®å‰è©•åˆ†è¼ƒä½ï¼Œé¡¯ç¤ºç¼ºä¹å¸‚å ´ç†±é»æˆ–ç±Œç¢¼å„ªå‹¢ã€‚å»ºè­°è§€æœ›ï¼Œæˆ–ä»¥æ¥µä½åƒ¹æ ¼ï¼ˆæ¥è¿‘åº•åƒ¹ï¼‰å˜—è©¦æ’¿ä¾¿å®œã€‚<br><br>ğŸš« å»ºè­°ï¼šé™¤éå°è©²å…¬å¸æœ‰æ·±å…¥äº†è§£ï¼Œå¦å‰‡ä¸å»ºè­°é‡å£“ã€‚`;
            }
        }
    </script>
</body>
</html>
