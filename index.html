<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤ - å¯è½‰å‚µç«¶æ‹æ•¸æ“š</title>
    <style>
        /* --- é€™æ˜¯æ¨£å¼å€ (CSS) --- */
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }

        /* æœå°‹æ¡†æ¨£å¼ */
        .search-box {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box; /* ç¢ºä¿å…§è·ä¸å½±éŸ¿å¯¬åº¦ */
        }

        /* è¡¨æ ¼æ¨£å¼ */
        .table-wrapper {
            overflow-x: auto; /* æ‰‹æ©Ÿç‰ˆå¯ä»¥å·¦å³æ»‘å‹• */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #2980b9; /* Rexè— */
            color: white;
            white-space: nowrap; /* æ¨™é¡Œä¸æ›è¡Œ */
            position: sticky;
            top: 0;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        .loading {
            text-align: center;
            font-size: 18px;
            color: #e67e22;
            font-weight: bold;
            padding: 20px;
        }

        .error-msg {
            color: red;
            text-align: center;
            font-weight: bold;
        }
        
        /* é å°¾ */
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: #aaa;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>å¯è½‰å‚µç«¶æ‹æ•¸æ“šç³»çµ±</h1>
    <div class="subtitle">Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</div>

    <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” è¼¸å…¥é—œéµå­—æœå°‹ (ä¾‹å¦‚ï¼šä»£è™Ÿã€åç¨±)...">

    <div id="statusMessage" class="loading">æ­£åœ¨è®€å–æ•¸æ“šè³‡æ–™åº«...</div>
    
    <div class="table-wrapper">
        <table id="dataTable">
            <thead>
                <tr id="tableHeadRow"></tr>
            </thead>
            <tbody id="tableBody">
                </tbody>
        </table>
    </div>
    
    <div class="footer">
        Data Source: cb_data_integrated.json | Powered by Uncle Rex
    </div>
</div>

<script>
    /* --- é€™æ˜¯ç¨‹å¼é‚è¼¯å€ (JavaScript) --- */
    
    // è¨­å®šä½ çš„æª”æ¡ˆåç¨± (å¿…é ˆè·Ÿ GitHub ä¸Šä¸€æ¨¡ä¸€æ¨£)
    const DATA_FILE = './cb_data_integrated.json';

    let rawData = []; // å„²å­˜åŸå§‹è³‡æ–™

    // 1. ç¶²é è¼‰å…¥å¾Œç«‹å³åŸ·è¡Œ
    document.addEventListener('DOMContentLoaded', () => {
        fetchData();
        
        // è¨­å®šæœå°‹åŠŸèƒ½çš„ç›£è½å™¨
        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            const keyword = e.target.value.toLowerCase();
            filterData(keyword);
        });
    });

    // 2. è®€å– JSON æª”æ¡ˆ
    function fetchData() {
        fetch(DATA_FILE)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP éŒ¯èª¤ï¼ç‹€æ…‹ç¢¼: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('æ•¸æ“šè®€å–æˆåŠŸ:', data);
                
                // æª¢æŸ¥è³‡æ–™æ ¼å¼ï¼Œå¦‚æœæ˜¯ç‰©ä»¶åŒ…é™£åˆ—ï¼Œå˜—è©¦ä¿®æ­£
                if (!Array.isArray(data) && data.data && Array.isArray(data.data)) {
                     rawData = data.data;
                } else if (Array.isArray(data)) {
                     rawData = data;
                } else {
                     // å¦‚æœåªæœ‰å–®ç­†è³‡æ–™æˆ–æ ¼å¼ç‰¹æ®Š
                     rawData = [data]; 
                }

                if (rawData.length === 0) {
                    document.getElementById('statusMessage').innerText = 'è³‡æ–™åº«æ˜¯ç©ºçš„ã€‚';
                    return;
                }

                document.getElementById('statusMessage').style.display = 'none'; // éš±è—è¼‰å…¥ä¸­è¨Šæ¯
                renderTable(rawData); // ç•«å‡ºè¡¨æ ¼
            })
            .catch(error => {
                console.error('è®€å–å¤±æ•—:', error);
                document.getElementById('statusMessage').className = 'error-msg';
                document.getElementById('statusMessage').innerHTML = `
                    è®€å–å¤±æ•—ã€‚<br>
                    è«‹ç¢ºèª GitHub ä¸Šæ˜¯å¦æœ‰ <b>${DATA_FILE.replace('./','')}</b> é€™å€‹æª”æ¡ˆã€‚<br>
                    éŒ¯èª¤è¨Šæ¯: ${error.message}
                `;
            });
    }

    // 3. å‹•æ…‹ç”¢ç”Ÿè¡¨æ ¼ (è‡ªå‹•æŠ“å–æ¬„ä½åç¨±)
    function renderTable(data) {
        const theadRow = document.getElementById('tableHeadRow');
        const tbody = document.getElementById('tableBody');
        
        theadRow.innerHTML = '';
        tbody.innerHTML = '';

        if (data.length === 0) return;

        // å–å¾—æ‰€æœ‰çš„æ¬„ä½åç¨± (å¾ç¬¬ä¸€ç­†è³‡æ–™æŠ“ key)
        const columns = Object.keys(data[0]);

        // å»ºç«‹è¡¨é ­ (th)
        columns.forEach(col => {
            const th = document.createElement('th');
            th.textContent = col; // æ¬„ä½åç¨±
            theadRow.appendChild(th);
        });

        // å»ºç«‹å…§å®¹ (tr, td)
        data.forEach(item => {
            const tr = document.createElement('tr');
            columns.forEach(col => {
                const td = document.createElement('td');
                td.textContent = item[col] !== null ? item[col] : ''; // å¦‚æœæ˜¯ null å°±é¡¯ç¤ºç©ºç™½
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });
    }

    // 4. æœå°‹éæ¿¾åŠŸèƒ½
    function filterData(keyword) {
        const filtered = rawData.filter(item => {
            // æŠŠé€™ä¸€è¡Œçš„æ‰€æœ‰å€¼ä¸²æˆä¸€å€‹å­—ä¸²ä¾†æœå°‹
            const rowString = Object.values(item).join(' ').toLowerCase();
            return rowString.includes(keyword);
        });
        renderTable(filtered);
    }

</script>

</body>
</html>
