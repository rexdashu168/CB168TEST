<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ™ºèƒ½ç«¶æ‹è©•ä¼°ç³»çµ± v4.2 (æ¬Šé‡ç²¾ç®—ç‰ˆ) - Rexå¤§å”</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        /* ================= é¢¨æ ¼è¨­å®š (ç¶­æŒåŸç‰ˆ) ================= */
        :root {
            --primary: #1565C0; 
            --secondary: #FF6F00;
            --bg-light: #f5f5f5;
            --text-main: #333;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Microsoft JhengHei', sans-serif; }
        body { background: var(--bg-light); padding: 20px; }
        .container { max-width: 1300px; margin: 0 auto; }
        
        /* Header & File Input */
        .header { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 24px; color: var(--primary); margin: 0; }
        .file-btn { background: var(--primary); color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; border: none; font-size: 15px; }
        .file-status { font-size: 14px; color: #666; margin-left: 10px; font-weight: bold; }

        /* Main Layout */
        .main-grid { display: grid; grid-template-columns: 350px 1fr; gap: 20px; }
        
        /* Panel */
        .panel { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .panel-title { font-size: 18px; font-weight: bold; color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 20px; }
        
        /* Forms */
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 14px; color: #666; margin-bottom: 5px; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 15px; }
        .form-group input:focus { border-color: var(--primary); outline: none; }
        
        .calc-btn { width: 100%; background: linear-gradient(135deg, #FF6F00, #FF8F00); color: white; font-size: 18px; font-weight: bold; padding: 12px; border: none; border-radius: 8px; cursor: pointer; margin-top: 10px; transition: transform 0.1s; }
        .calc-btn:active { transform: scale(0.98); }
        .calc-btn:disabled { background: #ccc; cursor: not-allowed; }

        /* Result Area */
        .result-box { display: none; }
        .price-display { background: #e3f2fd; padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px; border: 1px solid #bbdefb; }
        .price-display .label { font-size: 14px; color: #1565C0; }
        .price-display .value { font-size: 48px; font-weight: bold; color: #0D47A1; margin: 5px 0; }
        
        .strategy-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; }
        .strat-card { background: #fff; border: 1px solid #eee; padding: 15px; text-align: center; border-radius: 8px; }
        .strat-card.main { border: 2px solid var(--secondary); background: #fff8e1; }
        .strat-price { font-size: 24px; font-weight: bold; color: #333; margin-top: 5px; }
        
        /* Table */
        .analysis-table { width: 100%; border-collapse: collapse; font-size: 14px; margin-top: 10px; }
        .analysis-table th { background: #f5f5f5; padding: 10px; text-align: center; border-bottom: 2px solid #ddd; color: #444; }
        .analysis-table td { padding: 10px; text-align: center; border-bottom: 1px solid #eee; color: #333; }
        .analysis-table tr.total-row { background: #fff3e0; font-weight: bold; }
        .analysis-table tr.total-row td { border-top: 2px solid #ffb74d; color: #d35400; }
        
        .pos-val { color: #d32f2f; font-weight: bold; } /* ç´…è‰²ä»£è¡¨æº¢åƒ¹ */
        .neg-val { color: #388e3c; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <div>
                <h1>ğŸ¤– AI ç«¶æ‹å®šåƒ¹ç³»çµ± v4.2</h1>
                <span id="dbStatus" class="file-status">ğŸ”´ ç­‰å¾…è³‡æ–™åº«è¼‰å…¥...</span>
            </div>
            <div>
                <input type="file" id="excelInput" accept=".xlsx" style="display:none" onchange="handleFile(this)">
                <button class="file-btn" onclick="document.getElementById('excelInput').click()">ğŸ“‚ è¼‰å…¥ Excel æ­·å²è³‡æ–™</button>
            </div>
        </div>

        <div class="main-grid">
            <div class="panel">
                <div class="panel-title">ğŸ“ æ¨™çš„æ¢ä»¶è¨­å®š</div>
                <form id="calcForm">
                    <div class="form-group">
                        <label>1. ç”¢æ¥­åˆ†é¡ (30%)</label>
                        <select id="industry" required disabled><option>è«‹å…ˆè¼‰å…¥è³‡æ–™åº«</option></select>
                    </div>
                    <div class="form-group">
                        <label>2. ç™¼è¡Œè¦æ¨¡ (25%)</label>
                        <div style="display:flex; gap:5px;">
                            <input type="number" id="size" step="0.1" placeholder="å„„å…ƒ" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>3. æ“”ä¿ç‹€æ³ (20%)</label>
                        <select id="guarantee" required>
                            <option value="æœ‰æ“”ä¿">æœ‰æ“”ä¿</option>
                            <option value="ç„¡æ“”ä¿">ç„¡æ“”ä¿</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>4. ç™¼è¡Œåˆ¸å•† (15%)</label>
                        <select id="broker" required disabled><option>è«‹å…ˆè¼‰å…¥è³‡æ–™åº«</option></select>
                    </div>
                    <div class="form-group">
                        <label>5. è¨‚åƒ¹æº¢åƒ¹ç‡ (10%)</label>
                        <div style="display:flex; gap:5px;">
                            <input type="number" id="premium" step="0.1" placeholder="ä¾‹å¦‚ 102.5" required>
                        </div>
                    </div>
                    <hr style="margin: 20px 0; border:0; border-top:1px dashed #ccc;">
                    <div class="form-group">
                        <label>ç«¶æ‹æˆªæ­¢æ”¶ç›¤åƒ¹ (å…ƒ)</label>
                        <input type="number" id="stockPrice" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label>è½‰æ›åƒ¹æ ¼ (å…ƒ)</label>
                        <input type="number" id="convPrice" step="0.1" required>
                    </div>

                    <button type="submit" id="btnSubmit" class="calc-btn" disabled>é–‹å§‹ç²¾ç®—åƒ¹æ ¼</button>
                </form>
            </div>

            <div class="panel result-box" id="resultBox">
                <div class="panel-title">ğŸ“Š æº¢åƒ¹ç‡åˆ†è§£èˆ‡å®šåƒ¹åˆ†æ</div>
                
                <div class="price-display">
                    <div class="label">ç†è«–åƒ¹æ ¼</div>
                    <div class="value" id="theoPrice">--</div>
                    <div style="font-size:14px; color:#666;">(è‚¡åƒ¹ / è½‰åƒ¹ x 100)</div>
                </div>

                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>è©•ä¼°æ¢ä»¶</th>
                            <th>è¼¸å…¥å€¼</th>
                            <th>æ¬Šé‡</th>
                            <th>æ­·å²å¹³å‡æº¢åƒ¹ç‡</th>
                            <th>åŠ æ¬Šè²¢ç»</th>
                        </tr>
                    </thead>
                    <tbody id="analysisBody">
                        </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td colspan="3" style="text-align:right; padding-right:20px;">ç¶œåˆé æœŸæº¢åƒ¹ç‡ï¼š</td>
                            <td id="avgRawPrem">--</td>
                            <td id="totalWeightedPrem">--</td>
                        </tr>
                    </tfoot>
                </table>

                <div style="margin-top:30px;">
                    <div class="panel-title" style="border:none; margin-bottom:10px;">ğŸ¯ å»ºè­°æŠ•æ¨™åƒ¹æ ¼çŸ©é™£</div>
                    <div style="color:#666; font-size:14px; margin-bottom:15px;">
                        è¨ˆç®—å…¬å¼ï¼šç†è«–åƒ¹æ ¼ Ã— (1 + ç¶œåˆé æœŸæº¢åƒ¹ç‡)
                    </div>
                    
                    <div class="strategy-grid">
                        <div class="strat-card">
                            <div style="color:#2e7d32; font-weight:bold;">ğŸ›¡ï¸ ä¿å®ˆ (-2%)</div>
                            <div class="strat-price" id="priceLow">--</div>
                        </div>
                        <div class="strat-card main">
                            <div style="color:#e65100; font-weight:bold;">âš–ï¸ åˆç†é ä¼° (åŸºæº–)</div>
                            <div class="strat-price" id="priceMid" style="font-size:32px;">--</div>
                        </div>
                        <div class="strat-card">
                            <div style="color:#c62828; font-weight:bold;">ğŸš€ ç©æ¥µ (+2%)</div>
                            <div class="strat-price" id="priceHigh">--</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === å…¨åŸŸè³‡æ–™ ===
        let DataPool = []; 
        
        // === Rexå¤§å”æŒ‡å®šæ¬Šé‡ ===
        const WEIGHTS = {
            industry: 0.30, // ç”¢æ¥­
            size: 0.25,     // è¦æ¨¡
            guarantee: 0.20,// æ“”ä¿
            broker: 0.15,   // åˆ¸å•†
            premium: 0.10   // è¨‚åƒ¹æº¢åƒ¹
        };

        // === 1. Excel è®€å–èˆ‡è§£æ ===
        function handleFile(input) {
            const file = input.files[0];
            if(!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const workbook = XLSX.read(e.target.result, {type: 'array'});
                    processWorkbook(workbook);
                } catch(err) {
                    alert("è®€å–å¤±æ•—: " + err.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function processWorkbook(workbook) {
            // è‡ªå‹•å°‹æ‰¾åŒ…å« "ç™¼è¡Œåˆ¸å•†" å’Œ "æ›ç‰Œæœ€é«˜" çš„å·¥ä½œè¡¨
            // æˆ‘å€‘éœ€è¦å…©å¼µè¡¨ï¼šä¸€å¼µæ˜¯å±¬æ€§è¡¨(ç«¶æ‹è³‡æ–™åº«)ï¼Œä¸€å¼µæ˜¯ç¸¾æ•ˆè¡¨(æ›ç‰Œé«˜ä½)
            
            let listAttr = [], listPerf = [];
            
            workbook.SheetNames.forEach(name => {
                const ws = workbook.Sheets[name];
                const json = XLSX.utils.sheet_to_json(ws, {defval:""});
                if(json.length === 0) return;

                const keys = Object.keys(json[0]);
                
                // åˆ¤æ–·ç‰¹å¾µ
                if(keys.includes('ç™¼è¡Œåˆ¸å•†') && keys.includes('ç”¢æ¥­åˆ†é¡')) listAttr = json;
                if(keys.includes('æ›ç‰Œæœ€é«˜') && keys.includes('åç¨±')) listPerf = json;
            });

            if(listAttr.length === 0 || listPerf.length === 0) {
                // å¦‚æœæ‰¾ä¸åˆ°åˆ†é–‹çš„è¡¨ï¼Œå˜—è©¦çœ‹çœ‹æ˜¯å¦å·²ç¶“åˆä½µåœ¨åŒä¸€å¼µè¡¨
                const allInOne = listAttr.length > 0 ? listAttr : listPerf;
                if(allInOne.length > 0 && 'ç™¼è¡Œåˆ¸å•†' in allInOne[0] && 'æ›ç‰Œæœ€é«˜' in allInOne[0]) {
                    DataPool = cleanData(allInOne);
                } else {
                    alert("éŒ¯èª¤ï¼šæ‰¾ä¸åˆ°å®Œæ•´çš„è³‡æ–™æ¬„ä½ã€‚\nè«‹ç¢ºèª Excel åŒ…å« 'ç™¼è¡Œåˆ¸å•†', 'ç”¢æ¥­åˆ†é¡', 'ç™¼è¡Œè¦æ¨¡', 'æ›ç‰Œæœ€é«˜' ç­‰æ¬„ä½ã€‚");
                    return;
                }
            } else {
                // é€²è¡Œåˆä½µ
                DataPool = mergeData(listAttr, listPerf);
            }

            if(DataPool.length > 0) {
                document.getElementById('dbStatus').innerHTML = `ğŸŸ¢ å·²è¼‰å…¥ ${DataPool.length} ç­†æœ‰æ•ˆè³‡æ–™`;
                document.getElementById('dbStatus').style.color = 'green';
                enableForm();
                initOptions();
            }
        }

        function mergeData(attrs, perfs) {
            // å»ºç«‹ç¸¾æ•ˆç´¢å¼• (Key: åç¨± æˆ– ä»£è™Ÿ)
            let pMap = {};
            perfs.forEach(p => {
                let name = String(p['åç¨±']).trim();
                if(name) pMap[name] = p;
            });

            let result = [];
            attrs.forEach(a => {
                let name = String(a['åç¨±'] || a['CBåç¨±']).trim();
                let match = pMap[name];
                
                if(match) {
                    // åˆä½µæ¬„ä½
                    result.push({
                        ...a,
                        'æ›ç‰Œæœ€é«˜': parseFloat(match['æ›ç‰Œæœ€é«˜']) || 0,
                        'æ›ç‰Œæœ€ä½': parseFloat(match['æ›ç‰Œæœ€ä½']) || 0,
                        'å¹³å‡å¾—æ¨™': parseFloat(match['å¹³å‡å¾—æ¨™'] || a['å¹³å‡å¾—æ¨™']) || 0
                    });
                }
            });
            return cleanData(result);
        }

        function cleanData(data) {
            // æ¸…æ´—æ•¸æ“šï¼Œè¨ˆç®—å–®ç­†æº¢åƒ¹ç‡
            // æº¢åƒ¹ç‡å®šç¾©ï¼š(æ›ç‰Œæœ€é«˜ - 100) / 100 ? æˆ–è€…æ˜¯ (å¹³å‡å¾—æ¨™ - 100) ?
            // æ ¹æ“šæ‚¨çš„éœ€æ±‚ï¼šã€Œæˆ‘è¦æ ¹æ“šé€™å€‹è­°åƒ¹ç‡å»è¨ˆç®—...ã€
            // é€šå¸¸ç«¶æ‹çš„ã€Œå¾—æ¨™æº¢åƒ¹ç‡ã€= (å¾—æ¨™å‡åƒ¹ - 100)%ã€‚
            // ä½†æ‚¨æåˆ°ã€Œæ›ç‰Œè¡¨ç¾ã€ï¼Œå¦‚æœæ˜¯è¦é æ¸¬ã€Œæ›ç‰Œåƒ¹æ ¼ã€ï¼Œæˆ‘å€‘æ‡‰è©²åˆ†æã€Œæ›ç‰Œæº¢åƒ¹ã€ã€‚
            // é€™è£¡æˆ‘å…ˆä»¥ã€Œå¹³å‡å¾—æ¨™åƒ¹æ ¼ã€çš„æº¢åƒ¹ç‡ä½œç‚ºçµ±è¨ˆåŸºç¤ï¼Œå› ç‚ºé€™æ˜¯ç«¶æ‹ç•¶ä¸‹çš„æ•¸æ“šã€‚
            
            return data.map(d => {
                let avgBid = parseFloat(d['å¹³å‡å¾—æ¨™'] || d['å¾—æ¨™åŠ æ¬Šå¹³å‡åƒ¹æ ¼']);
                let premium = 0;
                if(avgBid > 0) {
                    premium = (avgBid - 100); // å‡è¨­åº•åƒ¹100ï¼Œæº¢åƒ¹ç‡å³ç‚ºè¶…é100çš„éƒ¨åˆ†
                }
                
                return {
                    ind: d['ç”¢æ¥­åˆ†é¡'] || d['ç”¢æ¥­åˆ¥'],
                    size: parseFloat(d['ç™¼è¡Œè¦æ¨¡']),
                    guar: d['æ“”ä¿'] || '',
                    bro: d['ç™¼è¡Œåˆ¸å•†'] || d['ä¸»è¾¦åˆ¸å•†'],
                    premRate: parseFloat(d['è¨‚åƒ¹æº¢åƒ¹ç‡']) || 100, // é€™æ˜¯è½‰æ›åƒ¹çš„æº¢åƒ¹ç‡ (å¦‚102)
                    
                    // é€™æ˜¯æˆ‘å€‘ä¸»è¦åˆ†æçš„ç›®æ¨™ï¼šæ­·å²å¸‚å ´çµ¦äºˆçš„æº¢åƒ¹ (Premium)
                    // å³ï¼šå¤§å®¶é¡˜æ„èŠ±å¤šå°‘éŒ¢(è¶…é100)å»æ¨™å®ƒ
                    marketPremium: premium 
                };
            }).filter(d => d.marketPremium > -20 && d.marketPremium < 100); // éæ¿¾ç•°å¸¸å€¼
        }

        function initOptions() {
            // å¡«å……ä¸‹æ‹‰é¸å–®
            const inds = [...new Set(DataPool.map(d => d.ind))].filter(Boolean).sort();
            const bros = [...new Set(DataPool.map(d => d.bro))].filter(Boolean).sort();

            const selInd = document.getElementById('industry');
            const selBro = document.getElementById('broker');
            
            selInd.innerHTML = "";
            selBro.innerHTML = "";

            inds.forEach(i => selInd.add(new Option(i, i)));
            bros.forEach(b => selBro.add(new Option(b, b)));
        }

        function enableForm() {
            document.getElementById('industry').disabled = false;
            document.getElementById('broker').disabled = false;
            document.getElementById('btnSubmit').disabled = false;
        }

        // === 2. æ ¸å¿ƒé‹ç®— (çµ±è¨ˆèˆ‡åŠ æ¬Š) ===
        function calculate(inputs) {
            // 1. ç”¢æ¥­æ­·å²æº¢åƒ¹
            let setInd = DataPool.filter(d => d.ind === inputs.ind);
            let valInd = getAveragePremium(setInd);

            // 2. è¦æ¨¡æ­·å²æº¢åƒ¹ (ä½¿ç”¨å€é–“)
            // å€é–“å®šç¾©ï¼š <5, 5-10, 10-20, >20
            let setSize = DataPool.filter(d => {
                if(inputs.size <= 5) return d.size <= 5;
                if(inputs.size <= 10) return d.size > 5 && d.size <= 10;
                if(inputs.size <= 20) return d.size > 10 && d.size <= 20;
                return d.size > 20;
            });
            let valSize = getAveragePremium(setSize);

            // 3. æ“”ä¿æ­·å²æº¢åƒ¹
            // æ¨¡ç³Šæ¯”å° "æœ‰æ“”ä¿", "ç„¡æ“”ä¿"
            let setGuar = DataPool.filter(d => d.guar.includes(inputs.guar));
            let valGuar = getAveragePremium(setGuar);

            // 4. åˆ¸å•†æ­·å²æº¢åƒ¹
            let setBro = DataPool.filter(d => d.bro === inputs.bro);
            let valBro = getAveragePremium(setBro);

            // 5. è¨‚åƒ¹æº¢åƒ¹ç‡æ­·å²æº¢åƒ¹
            // å€é–“ï¼š <102, 102-105, >105
            let setPrem = DataPool.filter(d => {
                if(inputs.prem < 102) return d.premRate < 102;
                if(inputs.prem <= 105) return d.premRate >= 102 && d.premRate <= 105;
                return d.premRate > 105;
            });
            let valPrem = getAveragePremium(setPrem);

            // === åŠ æ¬Šè¨ˆç®— ===
            // å…¬å¼ï¼šSum ( è©²æ¢ä»¶æ­·å²å‡å€¼ * æ¬Šé‡ )
            let wInd = valInd * WEIGHTS.industry;
            let wSize = valSize * WEIGHTS.size;
            let wGuar = valGuar * WEIGHTS.guarantee;
            let wBro = valBro * WEIGHTS.broker;
            let wPrem = valPrem * WEIGHTS.premium;

            let totalWeightedPremium = wInd + wSize + wGuar + wBro + wPrem;

            return {
                vals: { valInd, valSize, valGuar, valBro, valPrem },
                weighted: { wInd, wSize, wGuar, wBro, wPrem },
                totalWeightedPremium
            };
        }

        function getAveragePremium(dataset) {
            if(dataset.length === 0) return 5.0; // è‹¥ç„¡æ•¸æ“šï¼Œçµ¦äºˆé è¨­å¸‚å ´å‡å€¼ 5%
            let sum = dataset.reduce((a, b) => a + b.marketPremium, 0);
            return sum / dataset.length;
        }

        // === 3. UI é¡¯ç¤º ===
        document.getElementById('calcForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const inputs = {
                ind: document.getElementById('industry').value,
                size: parseFloat(document.getElementById('size').value),
                guar: document.getElementById('guarantee').value,
                bro: document.getElementById('broker').value,
                prem: parseFloat(document.getElementById('premium').value),
                stock: parseFloat(document.getElementById('stockPrice').value),
                conv: parseFloat(document.getElementById('convPrice').value)
            };

            const res = calculate(inputs);
            
            // é¡¯ç¤ºçµæœå€
            document.getElementById('resultBox').style.display = 'block';

            // è¨ˆç®—ç†è«–åƒ¹
            let theoPrice = (inputs.stock / inputs.conv) * 100;
            document.getElementById('theoPrice').innerText = theoPrice.toFixed(2);

            // æ¸²æŸ“è¡¨æ ¼
            const mkRow = (name, inputVal, w, val, wVal) => `
                <tr>
                    <td style="text-align:left; font-weight:bold;">${name}</td>
                    <td>${inputVal}</td>
                    <td>${(w*100).toFixed(0)}%</td>
                    <td>${val.toFixed(2)}%</td>
                    <td class="pos-val">+${wVal.toFixed(2)}%</td>
                </tr>
            `;

            document.getElementById('analysisBody').innerHTML = 
                mkRow('1. ç”¢æ¥­åˆ†é¡', inputs.ind, WEIGHTS.industry, res.vals.valInd, res.weighted.wInd) +
                mkRow('2. ç™¼è¡Œè¦æ¨¡', inputs.size+'å„„', WEIGHTS.size, res.vals.valSize, res.weighted.wSize) +
                mkRow('3. æ“”ä¿ç‹€æ³', inputs.guar, WEIGHTS.guarantee, res.vals.valGuar, res.weighted.wGuar) +
                mkRow('4. ç™¼è¡Œåˆ¸å•†', inputs.bro, WEIGHTS.broker, res.vals.valBro, res.weighted.wBro) +
                mkRow('5. è¨‚åƒ¹æº¢åƒ¹', inputs.prem+'%', WEIGHTS.premium, res.vals.valPrem, res.weighted.wPrem);

            // ç¸½è¨ˆ
            document.getElementById('totalWeightedPrem').innerText = `+${res.totalWeightedPremium.toFixed(2)}%`;
            
            // è¨ˆç®—å»ºè­°åƒ¹æ ¼
            // å…¬å¼ï¼šç†è«–åƒ¹ * (1 + åŠ æ¬Šæº¢åƒ¹ç‡%)
            // ä¾‹å¦‚ ç†è«–åƒ¹ 100ï¼ŒåŠ æ¬Šæº¢åƒ¹ 5.5% -> é ä¼°å¾—æ¨™ 105.5
            
            let finalRate = 1 + (res.totalWeightedPremium / 100);
            let targetPrice = theoPrice * finalRate;

            document.getElementById('priceMid').innerText = targetPrice.toFixed(2);
            document.getElementById('priceLow').innerText = (targetPrice * 0.98).toFixed(2);
            document.getElementById('priceHigh').innerText = (targetPrice * 1.02).toFixed(2);
            
            // æ»¾å‹•åˆ°çµæœ
            document.getElementById('resultBox').scrollIntoView({behavior: 'smooth'});
        });

        // è‡ªå‹•è¼‰å…¥ (å¦‚æœåœ¨æœ¬æ©Ÿç’°å¢ƒæœ‰æª”æ¡ˆ)
        window.addEventListener('load', () => {
            // å˜—è©¦ fetch åŒç›®éŒ„ä¸‹çš„æª”æ¡ˆ (åƒ…é™ web server ç’°å¢ƒ)
            fetch('00_CB.xlsx').then(r => {
                if(r.ok) r.arrayBuffer().then(parseExcel);
            }).catch(() => {});
        });
    </script>
</body>
</html>
