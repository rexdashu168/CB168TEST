<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯è½‰å‚µç«¶æ‹æŸ¥è©¢ç³»çµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            padding: 20px; 
        }
        .container { 
            max-width: 1600px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 15px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.2); 
            overflow: hidden; 
        }
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 30px; 
            text-align: center; 
        }
        .header h1 { 
            font-size: 2rem; 
            margin-bottom: 10px; 
            font-weight: 600; 
        }
        .header p { 
            font-size: 0.95rem; 
            opacity: 0.9; 
        }
        .header-info { 
            display: flex; 
            justify-content: center; 
            gap: 30px; 
            margin-top: 15px; 
            flex-wrap: wrap; 
        }
        .header-info-item { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-size: 0.9rem; 
            background: rgba(255, 255, 255, 0.2); 
            padding: 8px 16px; 
            border-radius: 20px; 
            transition: all 0.3s ease; 
            cursor: pointer; 
        }
        .header-info-item:hover { 
            background: rgba(255, 255, 255, 0.35); 
            transform: translateY(-2px); 
        }

        .data-update-banner {
            background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%);
            padding: 12px 30px;
            text-align: center;
            color: #e65100;
            font-size: 0.9rem;
            border-bottom: 2px solid #ffcc80;
        }

        .tabs { 
            display: flex; 
            background: #f8f9fa; 
            border-bottom: 3px solid #dee2e6; 
        }
        .tab { 
            flex: 1; 
            padding: 12px 10px; 
            text-align: center; 
            font-size: 1rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s; 
            border-bottom: 3px solid transparent; 
            margin-bottom: -3px; 
            line-height: 1.3;
        }
        .tab:hover { 
            background: #e9ecef; 
        }
        .tab.active { 
            background: white; 
            border-bottom: 3px solid #667eea; 
            color: #667eea; 
        }
        
        .tab-content { 
            display: none; 
            padding: 30px; 
        }
        .tab-content.active { 
            display: block; 
        }
        
        .search-box { 
            max-width: 600px; 
            margin: 50px auto; 
            text-align: center; 
        }
        .search-box input { 
            width: 100%; 
            padding: 15px; 
            font-size: 1.1rem; 
            border: 3px solid #667eea; 
            border-radius: 10px; 
        }
        .search-box input:focus { 
            outline: none; 
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3); 
        }
        .search-hint { 
            color: #6c757d; 
            margin-top: 15px; 
            font-size: 0.9rem; 
        }
        
        .btn { 
            padding: 12px 30px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1rem; 
            font-weight: 600; 
            transition: all 0.3s; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .btn-primary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
        }
        .btn-primary:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); 
        }
        .btn-secondary { 
            background: #6c757d; 
            color: white; 
        }
        .btn-secondary:hover { 
            background: #5a6268; 
            transform: translateY(-2px); 
        }
        
        .stats-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
            background: white; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            font-size: 0.85rem;
        }
        .stats-table th { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 12px 8px; 
            text-align: center; 
            font-size: 0.8rem; 
            border: 1px solid rgba(255,255,255,0.2); 
            white-space: nowrap;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .stats-table th:hover {
            background: linear-gradient(135deg, #7c8ef0 0%, #8a5bb2 100%);
        }
        .stats-table th.sortable::after {
            content: ' â‡…';
            opacity: 0.5;
            font-size: 0.75rem;
            margin-left: 3px;
        }
        .stats-table th.sort-asc::after {
            content: ' â–²';
            opacity: 1;
            color: #ffd700;
            font-size: 0.75rem;
            margin-left: 3px;
        }
        .stats-table th.sort-desc::after {
            content: ' â–¼';
            opacity: 1;
            color: #ffd700;
            font-size: 0.75rem;
            margin-left: 3px;
        }
        .stats-table td { 
            padding: 10px 8px; 
            text-align: center; 
            border: 1px solid #dee2e6; 
            font-size: 0.8rem; 
        }
        .stats-table tr:nth-child(even) { 
            background: #f8f9fa; 
        }
        .stats-table tr:hover { 
            background: #e7f3ff; 
        }
        .stats-table .highlight { 
            background: #fff3cd !important; 
            font-weight: 600; 
        }
        
        .info-card { 
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%); 
            padding: 20px; 
            border-radius: 10px; 
            border-left: 4px solid #667eea; 
            margin-bottom: 20px; 
        }
        .info-card h4 { 
            color: #667eea; 
            margin-bottom: 15px; 
            font-size: 1.1rem; 
        }
        .info-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px; 
        }
        .info-item { 
            padding: 10px; 
            background: white; 
            border-radius: 6px; 
            text-align: center; 
        }
        .info-item .label { 
            font-size: 0.8rem; 
            color: #6c757d; 
            margin-bottom: 5px; 
        }
        .info-item .value { 
            font-size: 1.2rem; 
            font-weight: 700; 
            color: #495057; 
        }
        
        .positive { color: #dc3545; }  /* å°ç£ç¿’æ…£:ç´…è‰²ä»£è¡¨æº¢åƒ¹/ä¸Šæ¼² */
        .negative { color: #28a745; }  /* å°ç£ç¿’æ…£:ç¶ è‰²ä»£è¡¨æŠ˜åƒ¹/ä¸‹è·Œ */
        
        .filter-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .filter-group {
            margin-bottom: 15px;
        }
        
        .filter-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }
        
        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .investor-type-selector {
            background: linear-gradient(135deg, #e8eaf6 0%, #ffffff 100%);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #5c6bc0;
        }
        
        .radio-group {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1rem;
            cursor: pointer;
        }
        
        .radio-item input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .type-descriptions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .type-desc-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #5c6bc0;
        }
        
        .type-desc-card h5 {
            color: #5c6bc0;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .type-desc-card p {
            font-size: 0.85rem;
            color: #616161;
            line-height: 1.6;
        }
        
        .warning-banner {
            background: linear-gradient(135deg, #fff3cd 0%, #ffffff 100%);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .warning-banner h4 {
            color: #d32f2f;
            margin-bottom: 10px;
        }
        
        .warning-banner p {
            color: #424242;
            line-height: 1.8;
            margin: 5px 0;
        }

        .calculator-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .calculator-input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .result-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%);
            border-left: 4px solid #2196f3;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .price-chart {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .price-line {
            padding: 8px 0;
        }

        .your-price-line {
            background: #fff3cd;
            font-weight: 600;
            padding: 10px;
            border-left: 4px solid #ffc107;
            margin: 5px 0;
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .collapsible {
            background: #e3f2fd;
            cursor: pointer;
            padding: 15px;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1rem;
            font-weight: 600;
            width: 100%;
            border-radius: 8px;
            margin-bottom: 10px;
            color: #1565c0;
        }

        .collapsible:hover {
            background: #bbdefb;
        }

        .collapsible-content {
            display: none;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .collapsible-content.active {
            display: block;
        }

        .condition-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        label:has(.condition-checkbox):hover {
            background: #e1bee7 !important;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(156, 39, 176, 0.2);
        }

        label:has(.condition-checkbox:checked) {
            background: #ce93d8 !important;
            border: 2px solid #9c27b0;
        }

        .footer { 
            padding: 20px 30px; 
            background: #f8f9fa; 
            border-top: 2px solid #e9ecef; 
            text-align: center; 
            color: #6c757d; 
            font-size: 0.85rem; 
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.5rem; }
            .tab { font-size: 0.9rem; padding: 15px 10px; }
            .radio-group { flex-direction: column; gap: 15px; }
            .calculator-input-group { grid-template-columns: 1fr; }
            .export-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ å¯è½‰å‚µç«¶æ‹æŸ¥è©¢ç³»çµ±</h1>
            <p style="margin-bottom: 15px;">ç«¶æ‹çµ±è¨ˆæ•¸æ“š | æ™ºèƒ½æ¨¡æ“¬åˆ†æ | æŠ•æ¨™åƒ¹æ ¼è©¦ç®—</p>
            <div class="header-info">
                <div class="header-info-item"><span>ğŸ“…</span><span id="currentDate">è¼‰å…¥ä¸­...</span></div>
                <div class="header-info-item" onclick="window.open('https://vocus.cc/salon/655c9dbcfd897800019d5bb4', '_blank')"><span>ğŸ“</span><span>æ–¹æ ¼å­éƒ¨è½æ ¼</span></div>
                <div class="header-info-item" onclick="window.open('https://www.youtube.com/@rexdashu168', '_blank')"><span>ğŸ¬</span><span>YouTubeé »é“</span></div>
            </div>
            <p style="margin-top: 12px; font-size: 0.85rem; opacity: 0.85;">by Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</p>
        </div>

        <div class="data-update-banner" id="dataUpdateBanner">
            ğŸ“… æ­£åœ¨è¼‰å…¥ç«¶æ‹è³‡æ–™...
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('single')">ğŸ”<br>å–®æª”æŸ¥è©¢</div>
            <div class="tab" onclick="switchTab('batch')">ğŸ“Š<br>æ‰¹æ¬¡æŸ¥è©¢</div>
            <div class="tab" onclick="switchTab('filter')">âš™ï¸<br>æ¢ä»¶ç¯©é¸</div>
            <div class="tab" onclick="switchTab('calculator')">ğŸ¯<br>æŠ•æ¨™è¨ˆç®—æ©Ÿ</div>
            <div class="tab" onclick="switchTab('rules')">ğŸ“‹<br>ç«¶æ‹é ˆçŸ¥</div>
        </div>

        <div id="tab-single" class="tab-content active">
            <div class="search-box">
                <h2 style="margin-bottom: 20px; color: #495057;">ğŸ” å–®æª”æ­·å²æŸ¥è©¢</h2>
                <div style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #2196f3; text-align: left;">
                    <h4 style="color: #1976d2; margin-bottom: 12px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                        <span>ğŸ’¡</span><span>åŠŸèƒ½èªªæ˜</span>
                    </h4>
                    <div style="color: #424242; font-size: 0.9rem; line-height: 1.8;">
                        <p style="margin-bottom: 8px;"><strong>æŸ¥è©¢æ–¹å¼ï¼š</strong>è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿã€CBä»£è™Ÿæˆ–å…¬å¸åç¨±</p>
                        <p style="margin-bottom: 8px;"><strong>é¡¯ç¤ºå…§å®¹ï¼š</strong>è©²å…¬å¸æ‰€æœ‰æ­·æ¬¡ç™¼è¡Œçš„å¯è½‰å‚µç«¶æ‹è¨˜éŒ„</p>
                        <p style="margin-bottom: 0;"><strong>ä½¿ç”¨ç¯„ä¾‹ï¼š</strong>è¼¸å…¥ã€Œ3617ã€æˆ–ã€Œç¢©å¤©ã€ï¼Œå‘ˆç¾å®Œæ•´è©²å…¬å¸æ­·å²ç«¶æ‹è³‡æ–™</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; align-items: center; max-width: 600px; margin: 0 auto;">
                    <input type="text" id="singleSearchInput" placeholder="è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿã€CBä»£è™Ÿæˆ–å…¬å¸åç¨±" 
                        onkeyup="if(event.key==='Enter') executeSingleSearch()">
                    <button class="btn btn-primary" onclick="executeSingleSearch()">æŸ¥è©¢</button>
                </div>
                <p class="search-hint">æŸ¥è©¢è©²å…¬å¸æ‰€æœ‰å¯è½‰å‚µç«¶æ‹æ­·å²è¨˜éŒ„</p>
            </div>
            <div id="singleResult"></div>
        </div>

        <div id="tab-batch" class="tab-content">
            <div class="search-box">
                <h2 style="margin-bottom: 20px; color: #495057;">ğŸ“Š æ‰¹æ¬¡æ¯”è¼ƒæŸ¥è©¢</h2>
                
                <div style="background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%); padding: 25px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #4caf50;">
                    <h4 style="color: #2e7d32; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        <span>ğŸ“…</span><span>æ™‚é–“å€é–“å¿«é€ŸæŸ¥è©¢</span>
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 20px;">
                        <button class="btn btn-primary" onclick="queryByTimeRange(1)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘1å€‹æœˆ</button>
                        <button class="btn btn-primary" onclick="queryByTimeRange(3)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘3å€‹æœˆ</button>
                        <button class="btn btn-primary" onclick="queryByTimeRange(6)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘åŠå¹´</button>
                        <button class="btn btn-primary" onclick="queryByTimeRange(12)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘1å¹´</button>
                        <button class="btn btn-primary" onclick="queryByTimeRange(24)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘2å¹´</button>
                        <button class="btn btn-primary" onclick="queryByTimeRange(36)" style="font-size: 0.9rem; padding: 10px;">æœ€è¿‘3å¹´</button>
                    </div>
                    <p style="color: #616161; font-size: 0.85rem; margin: 0;">é»æ“ŠæŒ‰éˆ•è‡ªå‹•è¼‰å…¥è©²æœŸé–“æ‰€æœ‰ç«¶æ‹æ¨™çš„é€²è¡Œçµ±è¨ˆåˆ†æ</p>
                </div>

                <div style="background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%); padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #ff9800; text-align: left;">
                    <h4 style="color: #e65100; margin-bottom: 12px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                        <span>ğŸ’¡</span><span>æ‰‹å‹•åŠ å…¥æŸ¥è©¢</span>
                    </h4>
                    <div style="color: #424242; font-size: 0.9rem; line-height: 1.8;">
                        <p style="margin-bottom: 8px;"><strong>æŸ¥è©¢æ–¹å¼ï¼š</strong>è‡ªç”±åŠ å…¥å¤šæª”ä¸åŒæ¨™çš„é€²è¡Œæ¯”è¼ƒåˆ†æï¼ˆæœ€å¤š20æª”ï¼‰</p>
                        <p style="margin-bottom: 8px;"><strong>é¡¯ç¤ºå…§å®¹ï¼š</strong>ç¶œåˆçµ±è¨ˆè¡¨ã€æ™ºèƒ½æŠ•æ¨™å»ºè­°ï¼ˆä¿å®ˆ/ç©©å¥/ç©æ¥µï¼‰</p>
                        <p style="margin-bottom: 0;"><strong>é©åˆç”¨æ–¼ï¼š</strong>æ¯”è¼ƒä¸åŒå…¬å¸ã€è©•ä¼°æŠ•è³‡çµ„åˆã€åˆ¶å®šæŠ•æ¨™ç­–ç•¥</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; align-items: center; max-width: 600px; margin: 0 auto;">
                    <input type="text" id="batchSearchInput" placeholder="è¼¸å…¥ä»£è™Ÿæˆ–åç¨±å¾ŒæŒ‰EnteråŠ å…¥" 
                        onkeyup="if(event.key==='Enter') addToBatchList()">
                    <button class="btn btn-primary" onclick="addToBatchList()">åŠ å…¥</button>
                </div>
                <p class="search-hint">é€ç­†åŠ å…¥ä¸åŒæ¨™çš„ï¼Œå»ºç«‹è‡ªå·±çš„æ¯”è¼ƒæ¸…å–®</p>
                
                <div id="batchList" style="margin-top: 30px; max-width: 800px; margin-left: auto; margin-right: auto;"></div>
                
                <div id="batchButtons" style="display: none; margin-top: 20px; display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-primary" onclick="executeBatchSearch()">ğŸ” é–‹å§‹åˆ†æ</button>
                    <button class="btn btn-secondary" onclick="clearBatchList()">ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨</button>
                </div>
            </div>
            <div id="batchResult"></div>
            
            <div id="batchChecklist" style="display: none;">
                <div style="background: linear-gradient(135deg, #e8eaf6 0%, #ffffff 100%); padding: 25px; margin: 20px 30px; border-radius: 10px; border-left: 4px solid #5c6bc0;">
                    <h3 style="color: #3f51b5; margin-bottom: 15px;">ğŸ“‹ æŠ•æ¨™å‰åƒè€ƒæª¢æŸ¥æ¸…å–®</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="color: #d32f2f; font-weight: 600; margin-bottom: 8px;">â° æ™‚æ©Ÿé¸æ“‡</div>
                            <div style="font-size: 0.85rem; color: #616161; line-height: 1.6;">
                                âœ“ æˆªæ¨™æ—¥1:30æ”¶ç›¤å¾Œå†æŠ•æ¨™<br>
                                âœ“ é¿å…åƒ¹æ ¼æ³¢å‹•æœŸé–“æ±ºç­–<br>
                                âœ“ è¨ˆç®—ã€Œéœæ­¢çš„ç†è«–åƒ¹æ ¼ã€
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="color: #d32f2f; font-weight: 600; margin-bottom: 8px;">ğŸ’° é¢¨éšªè©•ä¼°</div>
                            <div style="font-size: 0.85rem; color: #616161; line-height: 1.6;">
                                âœ“ è¨ˆç®—æœ€å¤§æå¤±ï¼šæŠ•æ¨™åƒ¹-100å…ƒ<br>
                                âœ“ è©•ä¼°å¯æ‰¿å—çš„é¢¨éšªé‡‘é¡<br>
                                âœ“ è€ƒæ…®ä¿¡è©•ã€æ“”ä¿ã€å¹´æœŸ
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="color: #d32f2f; font-weight: 600; margin-bottom: 8px;">ğŸ“Š æ•¸æ“šåƒè€ƒ</div>
                            <div style="font-size: 0.85rem; color: #616161; line-height: 1.6;">
                                âœ“ åƒè€ƒæ­·å²å¹³å‡å¾—æ¨™åƒ¹<br>
                                âœ“ è§€å¯ŸæŠ•æ¨™å€æ•¸ï¼ˆæŠ•è³‡æ°›åœï¼‰<br>
                                âœ“ æ¯”è¼ƒåŒé¡æ¨™çš„è¡¨ç¾
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="color: #d32f2f; font-weight: 600; margin-bottom: 8px;">âš ï¸ é‡è¦æé†’</div>
                            <div style="font-size: 0.85rem; color: #616161; line-height: 1.6;">
                                âœ“ æŠ•æ¨™å¾Œç„¡æ³•å–æ¶ˆï¼ˆåƒ…èƒ½æ£„æ¨™ï¼‰<br>
                                âœ“ æŠ•å®Œæ¨™å‹™å¿…å†æ¬¡æª¢æŸ¥<br>
                                âœ“ ç¢ºä¿äº¤å‰²è³‡é‡‘å……è¶³
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 6px; font-size: 0.9rem; color: #856404;">
                        <strong>ğŸ’¡ Rexå¤§å”æé†’ï¼š</strong>å°ˆæ³¨æ–¼é¢¨éšªæ§åˆ¶ï¼Œä¸è¿½æ±‚æš´åˆ©ã€‚ç›®æ¨™æ˜¯ä»¥æœ€æ¥è¿‘æœ€ä½å¾—æ¨™åƒ¹æ‹åˆ°ï¼Œæ§åˆ¶æˆæœ¬æ‰æ˜¯é•·æœŸç²åˆ©çš„é—œéµã€‚
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-filter" class="tab-content">
            <h2 style="color: #495057; margin-bottom: 20px;">âš™ï¸ æ¢ä»¶ç¯©é¸åˆ†æ</h2>
            
            <div style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #2196f3;">
                <h4 style="color: #1976d2; margin-bottom: 12px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                    <span>ğŸ’¡</span><span>åŠŸèƒ½èªªæ˜</span>
                </h4>
                <div style="color: #424242; font-size: 0.9rem; line-height: 1.8;">
                    <p style="margin-bottom: 8px;"><strong>ç¨ç«‹åˆ†æï¼š</strong>æ­¤åŠŸèƒ½å¯ç¨ç«‹ä½¿ç”¨ï¼Œç›´æ¥é¡¯ç¤ºç¬¦åˆæ¢ä»¶çš„æ­·å²è³‡æ–™çµ±è¨ˆ</p>
                    <p style="margin-bottom: 8px;"><strong>è¼”åŠ©è¨ˆç®—æ©Ÿï¼š</strong>åˆ†æçµæœå¯ä½œç‚ºã€ŒæŠ•æ¨™è¨ˆç®—æ©Ÿã€çš„åƒè€ƒæ•¸æ“šä¾†æº</p>
                    <p style="margin-bottom: 0;"><strong>ä½¿ç”¨å»ºè­°ï¼š</strong>å…ˆåœ¨æ­¤è¨­å®šæ¢ä»¶æŸ¥çœ‹æ­·å²çµ±è¨ˆï¼Œå†åˆ°æŠ•æ¨™è¨ˆç®—æ©Ÿè©¦ç®—åƒ¹æ ¼</p>
                </div>
            </div>
            
            <div class="filter-section">
                <h3 style="color: #495057; margin-bottom: 20px;">ç¯©é¸æ¢ä»¶è¨­å®šï¼ˆå¯è‡ªç”±é¸æ“‡ 1~8 å€‹æ¢ä»¶çµ„åˆï¼‰</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div class="filter-group">
                        <label>ğŸ­ ç”¢æ¥­åˆ†é¡</label>
                        <select id="filterIndustry">
                            <option value="">å…¨éƒ¨</option>
                            <option value="åŒ–å­¸å·¥æ¥­">åŒ–å­¸å·¥æ¥­</option>
                            <option value="èˆªé‹æ¥­">èˆªé‹æ¥­</option>
                            <option value="è³‡è¨Šæœå‹™æ¥­">è³‡è¨Šæœå‹™æ¥­</option>
                            <option value="å…¶ä»–é›»å­æ¥­">å…¶ä»–é›»å­æ¥­</option>
                            <option value="æ²¹é›»ç‡ƒæ°£æ¥­">æ²¹é›»ç‡ƒæ°£æ¥­</option>
                            <option value="è¾²æ¥­ç§‘æŠ€æ¥­">è¾²æ¥­ç§‘æŠ€æ¥­</option>
                            <option value="æ–‡åŒ–å‰µæ„æ¥­">æ–‡åŒ–å‰µæ„æ¥­</option>
                            <option value="ç”ŸæŠ€é†«ç™‚æ¥­">ç”ŸæŠ€é†«ç™‚æ¥­</option>
                            <option value="å»ºæç‡Ÿé€ æ¥­">å»ºæç‡Ÿé€ æ¥­</option>
                            <option value="é›»å­é›¶çµ„ä»¶æ¥­">é›»å­é›¶çµ„ä»¶æ¥­</option>
                            <option value="é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­">é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­</option>
                            <option value="é›»æ©Ÿæ©Ÿæ¢°">é›»æ©Ÿæ©Ÿæ¢°</option>
                            <option value="åŠå°é«”æ¥­">åŠå°é«”æ¥­</option>
                            <option value="è­‰åˆ¸æ¥­">è­‰åˆ¸æ¥­</option>
                            <option value="é‹å‹•ä¼‘é–’">é‹å‹•ä¼‘é–’</option>
                            <option value="å…‰é›»æ¥­">å…‰é›»æ¥­</option>
                            <option value="ç¶ èƒ½ç’°ä¿">ç¶ èƒ½ç’°ä¿</option>
                            <option value="é›»å™¨é›»çºœ">é›»å™¨é›»çºœ</option>
                            <option value="å…¶ä»–æ¥­">å…¶ä»–æ¥­</option>
                            <option value="é€šä¿¡ç¶²è·¯æ¥­">é€šä¿¡ç¶²è·¯æ¥­</option>
                            <option value="é›»å­é€šè·¯æ¥­">é›»å­é€šè·¯æ¥­</option>
                            <option value="è§€å…‰é¤æ—…">è§€å…‰é¤æ—…</option>
                            <option value="è²¿æ˜“ç™¾è²¨æ¥­">è²¿æ˜“ç™¾è²¨æ¥­</option>
                            <option value="é‹¼éµå·¥æ¥­">é‹¼éµå·¥æ¥­</option>
                            <option value="æ±½è»Šå·¥æ¥­">æ±½è»Šå·¥æ¥­</option>
                            <option value="å±…å®¶ç”Ÿæ´»">å±…å®¶ç”Ÿæ´»</option>
                            <option value="é€ ç´™å·¥æ¥­">é€ ç´™å·¥æ¥­</option>
                            <option value="å¡‘è† å·¥æ¥­">å¡‘è† å·¥æ¥­</option>
                            <option value="ç´¡ç¹”çº–ç¶­">ç´¡ç¹”çº–ç¶­</option>
                            <option value="é£Ÿå“å·¥æ¥­">é£Ÿå“å·¥æ¥­</option>
                            <option value="æ•¸ä½é›²ç«¯">æ•¸ä½é›²ç«¯</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>ğŸ¢ ç™¼è¡Œåˆ¸å•†</label>
                        <select id="filterUnderwriter">
                            <option value="">å…¨éƒ¨</option>
                            <option value="çµ±ä¸€è­‰åˆ¸">çµ±ä¸€è­‰åˆ¸</option>
                            <option value="ç¬¬ä¸€é‡‘è­‰">ç¬¬ä¸€é‡‘è­‰</option>
                            <option value="åœ‹ç¥¨è­‰åˆ¸">åœ‹ç¥¨è­‰åˆ¸</option>
                            <option value="å¯Œé‚¦è­‰åˆ¸">å¯Œé‚¦è­‰åˆ¸</option>
                            <option value="æ°¸è±é‡‘è­‰">æ°¸è±é‡‘è­‰</option>
                            <option value="å‡±åŸºè­‰åˆ¸">å‡±åŸºè­‰åˆ¸</option>
                            <option value="å°æ–°è­‰åˆ¸">å°æ–°è­‰åˆ¸</option>
                            <option value="ä¸­ä¿¡è­‰åˆ¸">ä¸­ä¿¡è­‰åˆ¸</option>
                            <option value="ç¾¤ç›Šè­‰åˆ¸">ç¾¤ç›Šè­‰åˆ¸</option>
                            <option value="å°ä¸­éŠ€è­‰">å°ä¸­éŠ€è­‰</option>
                            <option value="å…ƒå¤§è­‰åˆ¸">å…ƒå¤§è­‰åˆ¸</option>
                            <option value="åœ‹æ³°è­‰åˆ¸">åœ‹æ³°è­‰åˆ¸</option>
                            <option value="è¯å—æ°¸æ˜Œ">è¯å—æ°¸æ˜Œ</option>
                            <option value="åˆåº«è­‰åˆ¸">åˆåº«è­‰åˆ¸</option>
                            <option value="ç¦é‚¦è­‰åˆ¸">ç¦é‚¦è­‰åˆ¸</option>
                            <option value="å…†è±è­‰åˆ¸">å…†è±è­‰åˆ¸</option>
                            <option value="å®é è­‰åˆ¸">å®é è­‰åˆ¸</option>
                            <option value="æ°¸è±è­‰åˆ¸">æ°¸è±è­‰åˆ¸</option>
                            <option value="åº·å’Œè­‰åˆ¸">åº·å’Œè­‰åˆ¸</option>
                            <option value="å…ƒå¯Œè­‰åˆ¸">å…ƒå¯Œè­‰åˆ¸</option>
                            <option value="ç‰å±±è­‰åˆ¸">ç‰å±±è­‰åˆ¸</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>ğŸ“Š è‚¡æœ¬å€é–“</label>
                        <select id="filterCapital">
                            <option value="">å…¨éƒ¨</option>
                            <option value="<3">å°æ–¼3å„„</option>
                            <option value="3-6">3~6å„„</option>
                            <option value="6-10">6~10å„„</option>
                            <option value="10-15">10~15å„„</option>
                            <option value="15-20">15~20å„„</option>
                            <option value=">20">20å„„ä»¥ä¸Š</option>
                            <option value="<10">å°æ–¼10å„„</option>
                            <option value=">10">å¤§æ–¼10å„„</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>ğŸ’° ç™¼è¡Œè¦æ¨¡</label>
                        <select id="filterScale">
                            <option value="">å…¨éƒ¨</option>
                            <option value="<2">å°æ–¼2å„„</option>
                            <option value="2-3">2~3å„„</option>
                            <option value="3-6">3~6å„„</option>
                            <option value="6-10">6~10å„„</option>
                            <option value="10-15">10~15å„„</option>
                            <option value="15-20">15~20å„„</option>
                            <option value=">20">20å„„ä»¥ä¸Š</option>
                            <option value="<5">5å„„ä»¥ä¸‹</option>
                            <option value=">5">5å„„ä»¥ä¸Š</option>
                            <option value="<10">10å„„ä»¥ä¸‹</option>
                            <option value=">10">10å„„ä»¥ä¸Š</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>ğŸ’µ è½‰æ›åƒ¹æ ¼</label>
                        <select id="filterConvPrice">
                            <option value="">å…¨éƒ¨</option>
                            <option value="<20">20å…ƒä»¥ä¸‹</option>
                            <option value="20-50">20~50å…ƒ</option>
                            <option value="50-100">50~100å…ƒ</option>
                            <option value="100-150">100~150å…ƒ</option>
                            <option value="150-200">150~200å…ƒ</option>
                            <option value=">200">200å…ƒä»¥ä¸Š</option>
                            <option value="<50">50å…ƒä»¥ä¸‹</option>
                            <option value=">50">50å…ƒä»¥ä¸Š</option>
                            <option value="<100">100å…ƒä»¥ä¸‹</option>
                            <option value=">100">100å…ƒä»¥ä¸Š</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>â­ TCRIä¿¡ç”¨è©•ç­‰</label>
                        <select id="filterRating">
                            <option value="">å…¨éƒ¨</option>
                            <option value="2">2åˆ†</option>
                            <option value="3">3åˆ†</option>
                            <option value="4">4åˆ†</option>
                            <option value="5">5åˆ†</option>
                            <option value="6">6åˆ†</option>
                            <option value="7">7åˆ†</option>
                            <option value="8">8åˆ†</option>
                            <option value="9">9åˆ†</option>
                            <option value="<=4">4åˆ†ä»¥ä¸‹ï¼ˆå«ï¼‰</option>
                            <option value=">=5">5åˆ†ä»¥ä¸Šï¼ˆå«ï¼‰</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>ğŸ“… ç™¼è¡Œå¹´æœŸ</label>
                        <select id="filterPeriod">
                            <option value="">å…¨éƒ¨</option>
                            <option value="3">3å¹´</option>
                            <option value="5">5å¹´</option>
                            <option value="7">7å¹´</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>ğŸ›¡ï¸ æ“”ä¿æƒ…æ³</label>
                        <select id="filterSecured">
                            <option value="">å…¨éƒ¨</option>
                            <option value="æœ‰">æœ‰æ“”ä¿</option>
                            <option value="ç„¡">ç„¡æ“”ä¿</option>
                        </select>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px; display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-primary" onclick="executeFilterSearch()">ğŸ” é–‹å§‹åˆ†æ</button>
                    <button class="btn btn-secondary" onclick="resetFilters()">ğŸ”„ é‡ç½®æ¢ä»¶</button>
                </div>
            </div>
            
            <div id="filterResult"></div>
        </div>

        <div id="tab-calculator" class="tab-content">
            <h2 style="color: #495057; margin-bottom: 20px; text-align: center;">ğŸ¯ æŠ•æ¨™è¨ˆç®—æ©Ÿèˆ‡æ¢ä»¶åˆ†æ</h2>
            
            <div style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 4px solid #2196f3;">
                <h3 style="color: #1976d2; margin-bottom: 15px; font-size: 1.1rem;">ğŸ“Š æ ¸å¿ƒåŠŸèƒ½ï¼šæ¢ä»¶çµ±è¨ˆåˆ†æ</h3>
                <div style="color: #424242; font-size: 0.9rem; line-height: 1.8;">
                    <p style="margin-bottom: 12px;">
                        æœ¬åŠŸèƒ½è®“æ‚¨<strong style="color: #1976d2;">è‡ªç”±çµ„åˆå¤šå€‹ç¯©é¸æ¢ä»¶</strong>ï¼Œç³»çµ±æœƒæ ¹æ“šæ­·å²æ•¸æ“šè¨ˆç®—å‡ºç¬¦åˆæ¢ä»¶çš„çµ±è¨ˆçµæœï¼Œå¹«åŠ©æ‚¨è©•ä¼°æŠ•æ¨™ç­–ç•¥ã€‚
                    </p>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <p style="margin-bottom: 10px; font-weight: 600; color: #2e7d32;">ğŸ¯ ä½¿ç”¨æµç¨‹ï¼š</p>
                        <div style="display: grid; gap: 10px;">
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <span style="background: #2196f3; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: 600;">1</span>
                                <span><strong>é¸æ“‡æ¢ä»¶ï¼š</strong>å‹¾é¸è‡³å°‘5å€‹ç¯©é¸æ¢ä»¶ï¼ˆè‚¡æœ¬ã€è¦æ¨¡ã€å¹´æœŸã€ä¿¡è©•ã€æ“”ä¿ç­‰ï¼‰</span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <span style="background: #2196f3; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: 600;">2</span>
                                <span><strong>ç³»çµ±åˆ†æï¼š</strong>è‡ªå‹•ç”Ÿæˆç¬¦åˆæ¢ä»¶çš„æ­·å²æ•¸æ“šçµ±è¨ˆè¡¨æ ¼</span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <span style="background: #2196f3; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: 600;">3</span>
                                <span><strong>åƒè€ƒæŒ‡æ¨™ï¼š</strong>æŸ¥çœ‹ã€Œä¿å®ˆå‹ã€ã€ã€Œç©©å¥å‹ã€ã€ã€Œç©æ¥µå‹ã€ä¸‰ç¨®æŠ•æ¨™åƒ¹æ ¼å»ºè­°</span>
                            </div>
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <span style="background: #2196f3; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: 600;">4</span>
                                <span><strong>è‡ªè¡Œæ±ºç­–ï¼š</strong>æ ¹æ“šçµ±è¨ˆçµæœå’Œå€‹äººé¢¨éšªæ‰¿å—åº¦ï¼Œåˆ¶å®šæŠ•æ¨™ç­–ç•¥</span>
                            </div>
                        </div>
                    </div>
                    <p style="margin-top: 15px; padding: 12px; background: #fff3e0; border-radius: 6px; color: #e65100; font-size: 0.85rem;">
                        <strong>ğŸ’¡ æç¤ºï¼š</strong>æ‚¨å¯ä»¥å˜—è©¦ä¸åŒçš„æ¢ä»¶çµ„åˆï¼Œæ¯”è¼ƒåˆ†æçµæœï¼Œæ‰¾å‡ºæœ€é©åˆè‡ªå·±çš„æŠ•æ¨™ç­–ç•¥ã€‚é€™æ˜¯ä¸€å€‹ã€Œè‡ªåŠ©å¼åˆ†æå·¥å…·ã€ï¼Œè®“æ‚¨æŒæ¡ä¸»å‹•æ¬Šã€‚
                    </p>
                </div>
            </div>
            
            <button class="collapsible" onclick="toggleCollapsible(this)">âš ï¸ æŠ•æ¨™é¢¨éšªæé†’ï¼ˆé»æ“Šå±•é–‹ï¼‰</button>
            <div class="collapsible-content">
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 12px;">
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">ğŸ“Œ æŠ•æ¨™ä¸å¯å–æ¶ˆï¼š</strong>æŠ•æ¨™å¾Œç„¡æ³•å–æ¶ˆï¼Œè«‹è¬¹æ…å¡«å¯«åƒ¹æ ¼</p>
                        
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">ğŸ’° ä¿è­‰é‡‘è¦å®šï¼š</strong></p>
                        <p style="margin-bottom: 8px; padding-left: 20px;">â€¢ ä¿è­‰é‡‘ = æŠ•æ¨™ç¸½åƒ¹é‡‘ Ã— 50%</p>
                        <p style="margin-bottom: 10px; padding-left: 20px; background: #fff9c4; padding: 8px; border-radius: 4px;">
                            <strong>ç¯„ä¾‹ï¼š</strong>æŠ•æ¨™1å¼µã€åƒ¹æ ¼105å…ƒ<br>
                            â†’ ä¿è­‰é‡‘ = 1å¼µ Ã— 105,000å…ƒ Ã— 50% = <strong>52,500å…ƒ</strong>
                        </p>
                        
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">âŒ å¾—æ¨™æœªäº¤å‰²ï¼š</strong>è‹¥å¾—æ¨™å¾Œå°¾æ¬¾æœªç¹³äº¤ï¼Œ<strong>ä¿è­‰é‡‘å°‡è¢«æ²’æ”¶</strong></p>
                        
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">ğŸ’µ æ¨™å–®è™•ç†è²»ï¼š</strong></p>
                        <p style="margin-bottom: 8px; padding-left: 20px;">â€¢ æ¯ç­†æ¨™å–®è™•ç†è²» <strong>400å…ƒ</strong></p>
                        <p style="margin-bottom: 10px; padding-left: 20px; background: #fff9c4; padding: 8px; border-radius: 4px;">
                            <strong>ç¯„ä¾‹ï¼š</strong>å¯«3å€‹ä¸åŒåƒ¹æ ¼ = 3ç­†æ¨™å–® = <strong>1,200å…ƒ</strong>è™•ç†è²»
                        </p>
                        
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">ğŸ“Š å¼µæ•¸ä¸Šé™ï¼š</strong>æ¯æª”å¯è½‰å‚µæœ‰æŠ•æ¨™å¼µæ•¸ä¸Šé™ï¼Œ<strong>éœ€æ³¨æ„å…¬å‘Šè¦å®š</strong></p>
                        
                        <p style="margin-bottom: 10px;"><strong style="color: #d32f2f;">ğŸ”– å¾—æ¨™æ‰‹çºŒè²»ï¼š</strong></p>
                        <p style="margin-bottom: 0; padding-left: 20px;">â€¢ å¾—æ¨™æ‰‹çºŒè²» = å¾—æ¨™ç¸½åƒ¹é‡‘ Ã— (0.5% æˆ– 1%)</p>
                        <p style="padding-left: 20px; margin-top: 4px; font-size: 0.85rem; color: #616161;">
                            â€» æ‰‹çºŒè²»ç‡ä¾å„åˆ¸å•†å…¬å‘Šè€Œå®šï¼Œé€šå¸¸ç‚º 0.5% æˆ– 1%
                        </p>
                    </div>
                    <div style="background: #fff3cd; padding: 12px; border-radius: 6px; border-left: 3px solid #fbc02d;">
                        <strong style="color: #f57f17;">ğŸ’¡ é‡è¦å»ºè­°ï¼š</strong>è¬¹æ…è©•ä¼°è³‡é‡‘éœ€æ±‚ï¼Œé¿å…å› æœªäº¤å‰²è€Œæå¤±ä¿è­‰é‡‘
                    </div>
                </div>

            <div id="calculatorCheckConditions"></div>
            <div id="calculatorMain" style="display: none;">
                <div class="calculator-section">
                    <h3 style="color: #495057; margin-bottom: 20px;">ğŸ“Š ç†è«–åƒ¹å€¼è¨ˆç®—</h3>
                    <div class="calculator-input-group">
                        <div class="filter-group">
                            <label>è½‰æ›åƒ¹æ ¼ï¼ˆå…ƒï¼‰</label>
                            <input type="number" id="calcConvPrice" placeholder="ä¾‹å¦‚ï¼š44.00" step="0.01">
                        </div>
                        <div class="filter-group">
                            <label>è‚¡ç¥¨å¸‚åƒ¹ï¼ˆå…ƒï¼‰- æˆªæ¨™æ—¥1:30æ”¶ç›¤åƒ¹</label>
                            <input type="number" id="calcStockPrice" placeholder="ä¾‹å¦‚ï¼š41.20" step="0.01">
                        </div>
                        <div class="filter-group">
                            <label>ç†è«–åƒ¹å€¼ï¼ˆè‡ªå‹•è¨ˆç®—ï¼‰</label>
                            <input type="text" id="calcTheoretical" readonly style="background: #e9ecef; font-weight: 600;">
                        </div>
                    </div>
                </div>

                <div class="calculator-section">
                    <h3 style="color: #495057; margin-bottom: 20px;">ğŸ¯ æŠ•æ¨™åƒ¹æ ¼è©¦ç®—</h3>
                    <div class="calculator-input-group">
                        <div class="filter-group">
                            <label>æ‚¨æƒ³æŠ•æ¨™çš„åƒ¹æ ¼ï¼ˆå…ƒï¼‰</label>
                            <input type="number" id="calcBidPrice" placeholder="ä¾‹å¦‚ï¼š112.00" step="0.01">
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-primary" onclick="analyzePrice()">ğŸ” é–‹å§‹åˆ†æ</button>
                    </div>
                </div>

                <div id="calculatorResult"></div>
            </div>
        </div>

        <div class="warning-banner">
            <h4>âš ï¸ é‡è¦æç¤º</h4>
            <p>æœ¬ç³»çµ±æä¾›æ­·å²æ•¸æ“šçµ±è¨ˆèˆ‡è³‡æ–™æ•´ç†ï¼Œæ‰€æœ‰æ•¸æ“šåƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆä»»ä½•æŠ•è³‡å»ºè­°</p>
            <p>éå»è¡¨ç¾ä¸ä»£è¡¨æœªä¾†çµæœï¼ŒæŠ•è³‡æ±ºç­–è«‹è‡ªè¡Œè©•ä¼°é¢¨éšª</p>
        </div>

        <div class="footer">
            <p style="font-weight: 500;">è³‡æ–™ä¾†æºï¼šè­‰åˆ¸æ«ƒæª¯è²·è³£ä¸­å¿ƒ</p>
            <p style="margin-top: 8px; color: #f44336; font-weight: 500;">âš ï¸ æœ¬è¡¨åƒ…ä¾›åƒè€ƒï¼ŒæŠ•è³‡æ±ºç­–è«‹è‡ªè¡Œè©•ä¼°é¢¨éšª</p>
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #dee2e6;">
                <p style="font-weight: 600; color: #495057; margin-bottom: 12px;">ğŸ“š Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</p>
                <p style="font-size: 0.85rem; color: #6c757d;">æ›´å¤šæŠ•è³‡è§€å¿µèˆ‡å¯è½‰å‚µåˆ†æï¼Œæ­¡è¿è¨‚é–±å­¸ç¿’</p>
            </div>
        </div>

        <div id="tab-rules" class="tab-content">
            <div class="search-box">
                <h2 style="margin-bottom: 30px; color: #495057; text-align: center;">ğŸ“‹ å¯è½‰å‚µç«¶æ‹é ˆçŸ¥</h2>
                
                <div style="background: linear-gradient(135deg, #ffebee 0%, #ffffff 100%); padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #f44336;">
                    <h3 style="color: #c62828; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <span>âš ï¸</span><span>æŠ•æ¨™å‰å¿…è®€</span>
                    </h3>
                    <div style="color: #424242; font-size: 0.95rem; line-height: 1.8;">
                        <p style="margin-bottom: 10px;">æœ¬é é¢æ•´ç†å¯è½‰å‚µç«¶æ‹çš„é‡è¦è¦å‰‡èˆ‡æ³¨æ„äº‹é …ï¼Œè«‹æŠ•è³‡äººå‹™å¿…è©³ç´°é–±è®€ã€‚</p>
                        <p style="margin: 0; font-weight: 600; color: #d32f2f;">ğŸ“Œ æŠ•æ¨™å‰è«‹ç¢ºèªæ‚¨å·²äº†è§£æ‰€æœ‰è¦å‰‡ï¼Œé¿å…å› ä¸ç†Ÿæ‚‰è¦å®šè€Œé€ æˆæå¤±ã€‚</p>
                    </div>
                </div>

                <div class="collapsible active" onclick="toggleCollapsible(this)">
                    <span class="arrow">â–¼</span>
                    <span>ä¸ƒã€æŠ•æ¨™è™•ç†è²»ã€æŠ•æ¨™ä¿è­‰é‡‘</span>
                </div>
                <div class="collapsible-content active">
                    <div style="padding: 20px; background: white; border-radius: 8px; margin-bottom: 20px;">
                        
                        <h4 style="color: #1976d2; margin-bottom: 15px;">ï¼ˆä¸€ï¼‰æŠ•æ¨™ä¿è­‰é‡‘æˆæ•¸</h4>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                            <p style="color: #424242; line-height: 1.8; margin-bottom: 10px;">
                                <strong>æ¯ä¸€æŠ•æ¨™å–®ä¿è­‰é‡‘æˆæ•¸ç‚ºæŠ•æ¨™é‡‘é¡ä¹‹ç™¾åˆ†ä¹‹äº”åã€‚</strong>
                            </p>
                            <p style="color: #424242; line-height: 1.8; margin: 0;">
                                æŠ•æ¨™äººæ‡‰ç¹³ä¿è­‰é‡‘é‡‘é¡ï¼Œè«‹ä¾ä¸‹åˆ—å…¬å¼è¨ˆç®—ï¼š
                            </p>
                            <div style="background: white; padding: 15px; border-radius: 6px; margin-top: 10px; border-left: 3px solid #2196f3;">
                                <p style="margin: 0; color: #1976d2; font-weight: 600;">
                                    æ¯å¼µæŠ•æ¨™åƒ¹æ ¼ï¼š100 å…ƒ(å«)ä»¥ä¸Šï¼Œæ¯å¼µæŠ•æ¨™åƒ¹æ ¼æœ€å°å–®ä½è‡³åˆ†ç‚ºæ­¢ã€‚<br>
                                    ï¼ˆæŠ•æ¨™åƒ¹æ ¼ä»¥ç™¾å…ƒåƒ¹æ ¼è¨ˆç®—ï¼‰
                                </p>
                                <p style="margin: 15px 0 0 0; font-size: 1.1rem; font-weight: 700; color: #c62828;">
                                    æ¯ä¸€æŠ•æ¨™å–®æ‡‰ç¹³ä¿è­‰é‡‘ = æ¯å¼µæŠ•æ¨™åƒ¹æ ¼ Ã— 1,000 Ã— æŠ•æ¨™å¼µæ•¸ Ã— 50%
                                </p>
                            </div>
                        </div>

                        <h4 style="color: #1976d2; margin-bottom: 15px;">ï¼ˆäºŒï¼‰æŠ•æ¨™è™•ç†è²»</h4>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 6px; margin-bottom: 20px; border-left: 3px solid #ff9800;">
                            <p style="color: #424242; line-height: 1.8; margin: 0;">
                                æŠ•æ¨™äººåƒèˆ‡æŠ•æ¨™æ™‚ï¼Œ<strong style="color: #e65100;">æ¯ä¸€æŠ•æ¨™å–®æ‡‰ç¹³äº¤æŠ•æ¨™è™•ç†è²»æ–°å°å¹£ 400 å…ƒæ•´</strong>ã€‚<br>
                                <span style="color: #d32f2f;">æœªå¾—æ¨™ä»¶æˆ–ä¸åˆæ ¼ä»¶ï¼Œå…¶æŠ•æ¨™è™•ç†è²»å‡ä¸äºˆé€€å›ã€‚</span>
                            </p>
                        </div>

                        <h4 style="color: #1976d2; margin-bottom: 15px;">ï¼ˆä¸‰ï¼‰ä¿è­‰é‡‘èˆ‡è™•ç†è²»ç¹³æ¬¾æœŸé™</h4>
                        <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                            <p style="color: #424242; line-height: 1.8; margin: 0;">
                                æŠ•æ¨™ä¿è­‰é‡‘åŠæŠ•æ¨™è™•ç†è²»æˆªå­˜å¾€ä¾†éŠ€è¡Œæˆªæ­¢æ—¥ç‚º <strong>114å¹´10æœˆ23æ—¥</strong>ï¼›<br>
                                æŠ•æ¨™ä¿è­‰é‡‘åŠæŠ•æ¨™è™•ç†è²»å¾€ä¾†éŠ€è¡Œæ‰£ç¹³æ—¥ç‚º <strong>114å¹´10æœˆ27æ—¥</strong>ï¼ˆä¾éŠ€è¡Œå¯¦éš›ä¹‹æ‰£æ¬¾ä½œæ¥­ç‚ºæº–ï¼‰ã€‚
                            </p>
                        </div>

                        <h4 style="color: #1976d2; margin-bottom: 15px;">ï¼ˆå››ï¼‰æœªå¾—æ¨™åŠä¸åˆæ ¼ä»¶ä¿è­‰é‡‘é€€æ¬¾</h4>
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 6px; margin-bottom: 20px; border-left: 3px solid #4caf50;">
                            <p style="color: #424242; line-height: 1.8; margin: 0;">
                                æœªå¾—æ¨™åŠä¸åˆæ ¼ä»¶ä¿è­‰é‡‘é€€æ¬¾ä½œæ¥­ï¼š<br>
                                ç¶“ç´€å•†æ‡‰æ–¼é–‹æ¨™æ—¥æ¬¡ä¸€ç‡Ÿæ¥­æ—¥ï¼ˆ<strong>114å¹´10æœˆ29æ—¥</strong>ï¼‰ä¸Šåˆåé»å‰ï¼Œä¾è­‰äº¤æ‰€é›»è…¦è³‡æ–™ï¼Œ
                                æŒ‡ç¤ºå¾€ä¾†éŠ€è¡Œå°‡æœªå¾—æ¨™ï¼ˆåŒ…æ‹¬å–®ä¸€æŠ•æ¨™å–®éƒ¨ä»½æœªå¾—æ¨™ï¼‰åŠä¸åˆæ ¼ä»¶ä¹‹ä¿è­‰é‡‘ä¸åŠ è¨ˆåˆ©æ¯äºˆä»¥é€€å›ï¼Œ
                                <span style="color: #d32f2f;">æƒŸæŠ•æ¨™è™•ç†è²»ä¸äºˆé€€å›ã€‚</span>
                            </p>
                        </div>

                        <h4 style="color: #c62828; margin-bottom: 15px;">ï¼ˆäº”ï¼‰æœªå¦‚æœŸå±¥è¡Œç¹³æ¬¾ç¾©å‹™æ™‚çš„è™•ç†</h4>
                        <div style="background: #ffebee; padding: 15px; border-radius: 6px; border-left: 3px solid #f44336;">
                            <p style="color: #424242; line-height: 1.8; margin: 0;">
                                <strong style="color: #c62828;">å¾—æ¨™äººæœªå¦‚æœŸå±¥è¡Œç¹³æ¬¾ç¾©å‹™æ™‚ï¼Œé™¤å–ªå¤±å¾—æ¨™è³‡æ ¼å¤–ï¼ŒæŠ•æ¨™ä¿è­‰é‡‘æ‡‰ç”±ä¸»è¾¦è­‰åˆ¸å•†æ²’å…¥ä¹‹ï¼Œä¸¦ä¾è©²å¾—æ¨™äººå¾—æ¨™åƒ¹æ¬¾è‡ªè¡Œèªè³¼ã€‚</strong>
                            </p>
                        </div>

                        <h4 style="color: #d32f2f; margin-bottom: 15px;">ï¼ˆå…­ï¼‰åŒæ™‚æŠ•æ¨™å¤šç­†çš„ä¿è­‰é‡‘è¨ˆç®—</h4>
                        <div style="background: #fff9c4; padding: 15px; border-radius: 6px; border-left: 3px solid #fbc02d;">
                            <p style="color: #424242; line-height: 1.8;">
                                æŠ•æ¨™äººæŠ•ä»¶æ™‚éŠ€è¡Œå­˜æ¬¾é¤˜é¡æ‡‰è¶³ä»¥æ”¯ä»˜æŠ•æ¨™ä¿è­‰é‡‘åŠæŠ•æ¨™è™•ç†è²»ã€‚<br>
                                æŠ•æ¨™äººå¦‚å°±åŒä¸€ç«¶åƒ¹æ‹è³£æ¡ˆä»¶å¡«é€å¤šç­†æŠ•æ¨™å–®ï¼Œæˆ–æœ‰æ•¸å€‹ç«¶åƒ¹æ‹è³£æ¡ˆä»¶æ–¼åŒä¸€å¤©æˆªæ­¢æŠ•æ¨™ï¼Œ
                                ç•¶æŠ•æ¨™äººæŠ•ä»¶åƒèˆ‡å…¶ä¸­ä¸€å€‹ä»¥ä¸Šæ¡ˆä»¶æ™‚ï¼ŒæŠ•æ¨™äººéŠ€è¡Œå­˜æ¬¾ä¹‹æ‰£æ¬¾æ‡‰ä»¥å…¶æ‰€æœ‰æŠ•æ¨™å–®ä¹‹æŠ•æ¨™ä¿è­‰é‡‘åŠæŠ•æ¨™è™•ç†è²»ä¹‹åˆè¨ˆç‚ºæº–ï¼Œ
                                å¦å‰‡å…¨æ•¸ç‚ºä¸åˆæ ¼ä»¶ï¼Œæ‰€æœ‰æŠ•æ¨™å–®ä¹‹æŠ•æ¨™è™•ç†è²»å‡ä¸äºˆé€€å›ã€‚
                            </p>
                        </div>
                    </div>
                </div>

                <div class="collapsible active" onclick="toggleCollapsible(this)">
                    <span class="arrow">â–¼</span>
                    <span>åã€æŠ•æ¨™å–®ä¸åˆæ ¼ä»¶ä¹‹æƒ…äº‹</span>
                </div>
                <div class="collapsible-content active">
                    <div style="padding: 20px; background: white; border-radius: 8px; margin-bottom: 20px;">
                        <div style="background: #ffebee; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #f44336;">
                            <h4 style="color: #c62828; margin-bottom: 15px;">âš ï¸ ä»¥ä¸‹æƒ…æ³å°‡å°è‡´æŠ•æ¨™å–®ä¸åˆæ ¼</h4>
                            <p style="color: #424242; margin-bottom: 15px;">
                                æŠ•æ¨™å–®æœ‰ä¸‹åˆ—å„æ¬¾æƒ…äº‹ä¹‹ä¸€è€…ï¼Œç‚ºä¸åˆæ ¼ä»¶ï¼Œè©²æŠ•æ¨™å–®ä¸å¾—åƒèˆ‡ç«¶åƒ¹ï¼Œ<strong style="color: #d32f2f;">æŠ•æ¨™è™•ç†è²»å‡ä¸äºˆé€€å›</strong>ï¼š
                            </p>
                        </div>

                        <div style="display: grid; gap: 15px;">
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆä¸€ï¼‰æŠ•æ¨™åƒ¹æ ¼ä½æ–¼æœ€ä½æ‰¿éŠ·åƒ¹æ ¼æ¯å¼µ 100 å…ƒè€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆäºŒï¼‰æŠ•æ¨™æ•¸é‡ä½æ–¼ä¸‹é™ 1 å¼µæˆ–é«˜æ–¼ 850 å¼µï¼Œæˆ–éç‚º 1 å¼µä¹‹æ•´æ•¸å€æ•¸</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆä¸‰ï¼‰æœªç¹³è¶³æŠ•æ¨™ä¿è­‰é‡‘æˆ–æŠ•æ¨™è™•ç†è²»è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆå››ï¼‰æœªå¡«å¦¥äº¤æ˜“å¸³è™Ÿ(11ç¢¼)ï¼Œæˆ–è³‡æ–™ä¸å¯¦è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆäº”ï¼‰æœªå¡«å¦¥èº«åˆ†è­‰å­—è™Ÿæˆ–çµ±ä¸€ç·¨è™Ÿï¼Œæˆ–è³‡æ–™ä¸å¯¦è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆå…­ï¼‰è‡ªç„¶äººæœªå¡«å¦¥å‡ºç”Ÿå¹´æœˆæ—¥ï¼Œæˆ–è³‡æ–™ä¸å¯¦è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆä¸ƒï¼‰æœªå¡«å¦¥å‚µåˆ¸ä»£ç¢¼è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆå…«ï¼‰æŠ•æ¨™äººèº«åˆ†æŠµè§¸æœ¬å…¬å‘Šå…«ã€è¦å®šè€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆä¹ï¼‰æœªé–‹ç«‹äº¤æ˜“æˆ¶ã€æ¬¾é …åŠƒæ’¥éŠ€è¡Œå¸³æˆ¶æˆ–æœ‰å‚µè­‰åˆ¸ä¿ç®¡åŠƒæ’¥å¸³æˆ¶è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆåï¼‰æœªèˆ‡ç¶“ç´€å•†æŒ‡å®šä¹‹å¾€ä¾†éŠ€è¡Œå°±ç«¶åƒ¹æ‹è³£ç›¸é—œæ¬¾é …æ‰£ç¹³äº‹å®œç°½è¨‚å§”è¨—å¥‘ç´„è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆåä¸€ï¼‰æŠ•æ¨™äººæ¬¾é …åŠƒæ’¥éŠ€è¡Œå¸³æˆ¶ä¹‹å­˜æ¬¾é¤˜é¡ï¼Œä½æ–¼æ‰€æœ‰æŠ•æ¨™æœ‰åƒ¹è­‰åˆ¸åˆ¸ä¿è­‰é‡‘ã€æŠ•æ¨™è™•ç†è²»ä¹‹åˆè¨ˆé‡‘é¡è€…</div>
                            </div>
                            
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 6px; border-left: 3px solid #e64a19;">
                                <div style="color: #d84315; font-weight: 600; margin-bottom: 8px;">ï¼ˆåäºŒï¼‰åˆ©ç”¨æˆ–å†’ç”¨ä»–äººåç¾©æŠ•æ¨™è€…</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="collapsible active" onclick="toggleCollapsible(this)">
